[{"path":"https://bodkan.net/slendr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2020 Martin Petr Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Basic overview of the admixr package","text":"ADMIXTOOLS widely used software package calculating admixture statistics testing population admixture hypotheses. typical ADMIXTOOLS workflow generally involves combination sed/awk/shell scripting manual editing create text configuration files. passed command-line arguments one ADMIXTOOLS commands, control run particular analysis. results redirected another file, parsed user extract values interest, often using command-line utilities (worse) manual copy-pasting. Finally, processed results analysed R, Excel another program. workflow can little cumbersome, especially one wants explore many hypotheses involving different combinations populations. importantly, however, makes difficult coduct reproducible research, nearly impossible construct fully automated “pipelines” don’t require user intervention. R package makes possible perform stages ADMIXTOOLS analyses entirely R, completely removing need “low level” configuration individual ADMIXTOOLS programs.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Basic overview of the admixr package","text":"Note order use admixr package, need working installation ADMIXTOOLS! can find installation instructions . software runs Linux macOS two systems admixr tested . Furthermore, also need make sure R can find ADMIXTOOLS binaries $PATH. can achieve specifying PATH=<path location ADMIXTOOLS programs> .Renviron file. install admixr can simply run following command R session: Furthermore, want follow examples vignette, need tidyverse packages data manipulation plotting, can install : definitely don’t need tidyverse working admixr really makes data manipulation plotting things much easier. recommend least giving shot. everything ready, can run following code load packages:","code":"install.packages(\"admixr\") install.packages(c(\"dplyr\", \"ggplot2\", \"forcats\")) library(admixr)  library(dplyr) library(ggplot2) library(forcats)"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"a-note-about-eigenstrat-format","dir":"Articles","previous_headings":"","what":"A note about EIGENSTRAT format","title":"Basic overview of the admixr package","text":"ADMIXTOOLS software uses peculiar set genetic file formats, may seem strange used working VCF files. However, basic idea remains : want store access SNP data (REF/ALT alleles) set individuals defined set genomic positions. EIGENSTRAT datasets always contain three kinds files: ind file - specifies unique name, sex (optional - can simply “U” “undefined”) label (population assignment) sample; snp file - specifies positions SNPs, REF/ALT alleles etc.; 0: individual homozygous ALT 1: individual heterozygote 2: individual homozygous REF 9: missing data Therefore, VCF file essentially combination three files single package. Let’s first download small testing SNP dataset using built-admixr function download_data(). function downloads data temporary directory (can specify destination using dirname argument, case want place elsewhere). addition , function returns shared path/prefix whole dataset. can verify indeed three files prefix: Let’s look contents:","code":"(prefix <- download_data(dirname = tempdir())) [1] \"/var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps\" list.files(path = dirname(prefix), pattern = basename(prefix), full.names = TRUE) [1] \"/var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno\" [2] \"/var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind\"  [3] \"/var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp\""},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"ind-file","dir":"Articles","previous_headings":"A note about EIGENSTRAT format","what":"ind file","title":"Basic overview of the admixr package","text":"first column (sample name) third column (population label) generally (sample names often numerical suffixes make unique, etc.), kept simplicity. Importantly, specifying population/sample names admixr functions, information third column used. example, individuals “French1”, “French2”, “French3” first column ind file, three sharing “French” population label third column, specifying “French” admixr function combine three samples single population, instead working individual separately.","code":"Chimp        U  Chimp Mbuti        U  Mbuti Yoruba       U  Yoruba Khomani_San  U  Khomani_San Han          U  Han Dinka        U  Dinka Sardinian    U  Sardinian Papuan       U  Papuan French       U  French Vindija      U  Vindija Altai        U  Altai Denisova     U  Denisova"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"snp-file-first-3-lines","dir":"Articles","previous_headings":"A note about EIGENSTRAT format","what":"snp file (first 3 lines)","title":"Basic overview of the admixr package","text":"columns file , order: SNP string ID chromosome genetic distance position along chromosome reference allele alternative allele","code":"1_832756    1   0.008328    832756  T   G 1_838931    1   0.008389    838931  A   C 1_843249    1   0.008432    843249  A   T"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"geno-file-first-3-lines","dir":"Articles","previous_headings":"A note about EIGENSTRAT format","what":"geno file (first 3 lines)","title":"Basic overview of the admixr package","text":"row one genomic site, column genotype one individual.","code":"902021012000 922221211222 922222122222"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"philosophy-of-admixr","dir":"Articles","previous_headings":"","what":"Philosophy of admixr","title":"Basic overview of the admixr package","text":"goal admixr make ADMIXTOOLS analyses trivial run possible, without worry par/pop/left/right configuration files (known jargon ADMIXTOOLS) low-level details. interface ADMIXTOOLS following set R functions: d() f4() f4ratio() f3() qpAdm() qpWave() Anything normally require dozens lines shell scripts can often accomplished running single line R code.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"internal-representation-of-eigenstrat-data","dir":"Articles","previous_headings":"","what":"Internal representation of EIGENSTRAT data","title":"Basic overview of the admixr package","text":"saw , EIGENSTRAT dataset three components. way data internally represented admixr using small S3 R object created using eigenstrat constructor function. function accepts path prefix trio EIGENSTRAT snp/ind/geno files returns R object class EIGENSTRAT: object encapsulates paths three EIGENSTRAT components makes easy pass data different admixr functions. following couple sections describe use admixr package using simple example analyses.","code":"snps <- eigenstrat(prefix) snps #> EIGENSTRAT object #> ================= #> components: #>   ind file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind #>   snp file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp #>   geno file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"d-statistic","dir":"Articles","previous_headings":"","what":"D statistic","title":"Basic overview of the admixr package","text":"Let’s say interested following question: “populations today show evidence Neanderthal admixture? One way looking using following D statistic: D(present-day human W,African,Neanderthal,Chimp).D(\\textrm{present-day human W}, \\textrm{African}, \\textrm{Neanderthal}, \\textrm{Chimp}). DD statistics based comparing proportions BABA ABBA sites patterns observed data: D=# BABA sites - # ABBA sites# BABA sites + # ABBA sites.D = \\frac{\\textrm{# BABA sites - # ABBA sites}}{\\textrm{# BABA sites + # ABBA sites}}. Significant departure DD zero indicates excess allele sharing first third population (positive DD), excess allele sharing second third population (negative DD). get DD significantly different 0, suggests first second populations form clade, don’t differ rate allele sharing third population (null hypothesis data compared ). Therefore, DD statistic tests whether modern humans today admixed Neanderthals, increase genetic affinity archaic group compared Africans (whose ancestors never met Neanderthals). Let’s save population names first make code concise: Using admixr package can calculate DD statistic simply running: result following data frame: can see addition specified population names, output table contains additional columns: D - DD statistic value stderr - standard error DD statistic calculated using block jackknife Zscore - ZZ-zscore value (number standard errors DD 0, .e. strongly reject null hypothesis admixture) BABA, ABBA - counts observed site patterns nsnps - number SNPs used given calculation certainly make inferences looking ZZ-scores, tables general best representation kind data, especially number samples increases. Instead, can use ggplot2 package plot results:  (want know data analysis using R, including plotting ggplot2, highly recommend free book.) can see DD values Africans significantly different 0, meaning data consistent null hypothesis Neanderthal ancestry Africans. hand, test rejects null hypothesis non-Africans today, suggesting Neanderthals admixed ancestors present-day non-Africans.","code":"pops <- c(\"French\", \"Sardinian\", \"Han\", \"Papuan\", \"Khomani_San\", \"Mbuti\", \"Dinka\") result <- d(W = pops, X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\", data = snps) head(result) ggplot(result, aes(fct_reorder(W, D), D, color = abs(Zscore) > 2)) +   geom_point() +   geom_hline(yintercept = 0, linetype = 2) +   geom_errorbar(aes(ymin = D - 2 * stderr, ymax = D + 2 * stderr))"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"f4-statistic","dir":"Articles","previous_headings":"","what":"f4 statistic","title":"Basic overview of the admixr package","text":"alternative way addressing previous question use f4f_4 statistic, similar DD statistic can calculated : f4=# BABA sites - # ABBA sites# sites f_4 = \\frac{\\textrm{# BABA sites - # ABBA sites}}{\\textrm{# sites}} , significant departure f4f_4 0 can interpreted evidence gene flow. repeat previous analysis using f4f_4 statistic, can run function f4(): comparing result DD statistic analysis , can make conclusions. might wondering f4f_4 DD similar. truth f4f_4 , among things, directly informative amount shared genetic drift (“branch length”) pairs populations, useful theoretical property. , ’s often matter personal preference admixr provides functions calculating .","code":"result <- f4(W = pops, X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\", data = snps) head(result)"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"f4-ratio-statistic","dir":"Articles","previous_headings":"","what":"f4-ratio statistic","title":"Basic overview of the admixr package","text":"Now know non-Africans today carry Neanderthal ancestry. want know much Neanderthal ancestry ? proportion genomes Neanderthal origin? answer questions like , can use f4f_4-ratio statistic, can formulated following way (using notation Patterson et al., 2012, formally described properties). f4-ratio=f4(,O;X,C)f4(,O;B,C).f_4\\textrm{-ratio} = \\frac{f_4(, O; X, C)}{f_4(, O; B, C)}. Using amidxr, can calculate f4f_4-ratios using following code (X vector samples want estimate Neanderthal ancestry ): ancestry proportion (number 0 1) given alpha column:  can make several observations: , don’t see significant Neanderthal ancestry present-day Africans (proportion consistent 0%), confirmed using DD f4f_4 . Present-day non-Africans carry 2-3% Neanderthal ancestry. see much higher proportion Neanderthal ancestry people Papua New Guinea - 4%. consistent earlier studies suggest additional archaic admixture events ancestors present-day Papuans.","code":"result <- f4ratio(X = pops, A = \"Altai\", B = \"Vindija\", C = \"Yoruba\", O = \"Chimp\", data = snps) head(result) ggplot(result, aes(fct_reorder(X, alpha), alpha, color = abs(Zscore) > 2)) +   geom_point() +   geom_errorbar(aes(ymin = alpha - 2 * stderr, ymax = alpha + 2 * stderr)) +   geom_hline(yintercept = 0, linetype = 2) +   labs(y = \"Neandertal ancestry proportion\", x = \"present-day individual\")"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"f3-statistic","dir":"Articles","previous_headings":"","what":"f3 statistic","title":"Basic overview of the admixr package","text":"f3f_3 statistic, also known 3-population statistic, useful whenever want : Estimate branch length (shared genetic drift) pair populations AA BB respect common outgroup CC. case, higher f3f_3 value, longer shared evolutionary time AA BB. Test whether population CC mixture two populations AA BB. Significantly negative values f3f_3 statistic statistical evidence admixture. example, imagine interested relative divergence times pairs present-day human populations, want know approximate order split . address problem, use f3f_3 statistic fixing CC outgroup San, calculating pairwise f3f_3 statistics present-day modern humans.  can see order heatmap labels based values pairwise f3f_3 statistics, (already known) order population splits pops nicely (.e. San separated first, followed Mbuti, etc.).","code":"pops <- c(\"French\", \"Sardinian\", \"Han\", \"Papuan\", \"Mbuti\", \"Dinka\", \"Yoruba\")  result <- f3(A = pops, B = pops, C = \"Khomani_San\", data = snps) head(result) # sort the population labels according to an increasing f3 value relative to French ordered <- filter(result, A == \"Mbuti\", B != \"Mbuti\") %>% arrange(f3) %>% .[[\"B\"]] %>% c(\"Mbuti\")  # plot heatmap of pairwise f3 values result %>%   filter(A != B) %>%   mutate(A = factor(A, levels = ordered),          B = factor(B, levels = ordered)) %>%   ggplot(aes(A, B)) + geom_tile(aes(fill = f3))"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"qpwave-and-qpadm","dir":"Articles","previous_headings":"","what":"qpWave and qpAdm","title":"Basic overview of the admixr package","text":"qpWave qpAdm can though complex powerful extensions basic ideas behind simple f4f_4 statistic. Building upon f4f_4 theory generalizing , qpWave makes possible find lowest number “streams ancestry” two groups populations consistent data. Extending concept f4f_4 statistics even , qpAdm allows find proportions ancestry set ancestral populations contributed ancestry population interest. Unfortunately, methods represent rather advanced topic still lacks proper documentation beginner-friendly tutorials, explaining detail beyond scope vignette. want use , ’s crucial read official documentation decribing basic ideas methods (distributed ADMIXTOOLS), read relevant supplementary sections papers published David Reich’s group. least, recommend reading: Note S6 “Reconstructing Native American population history” Reich et al. paper first introduced theoretical background later became qpWave. Supplementary Information 10 “Massive migration steppe source Indo-European languages Europe” Haak et al., gives consise overview qpWave method S6 Reich et al. 2012, also introduces qpAdm methodology estimating admixture proportions. phenomenal description qpAdm methodology best practices Harney et al. 2020 (see also PDF practical guidelines made available supplementary document. documents really mandatory reading qpAdm analysis. remainder section, assume familiar methods, explain use admixr running R.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"qpwave","dir":"Articles","previous_headings":"qpWave and qpAdm","what":"qpWave","title":"Basic overview of the admixr package","text":"run qpWave, must provide list left right populations (using terminology Haak et al. 2015 ). aim method get idea number migration waves right left (back-migration left right!). done estimating rank matrix possible f4f_4 statistics f4(left1,lefti;right1,righti),f_4(\\textrm{left}_1, \\textrm{left}_i; \\textrm{right}_1, \\textrm{right}_i), left1\\textrm{left}_1 right1\\textrm{right}_1 fixed populations ii jj indices run possible choices populations. example, let’s try find number admixture waves right = {Yoruba, Mbuti, Alta} left = {French, Sardinian, Han} populations. can using function qpWave(), setting arguments appropriately: qpWave() function returns data frame shows results series matrix rank tests. rank column matrix rank tested, df, chisq tail give degrees freedom, χ2\\chi^2 value pp-value comparison saturated model (pp-value indicates matrix rank consistent data - see example ), dfdiff, chisqdiff taildiff give , always comparing model model one rank less. example, see matrix r=0r = 0 rejected (tail pp-value = 0.78). Reich et al. 2012 showed r+1≤nr + 1 \\le n, nn number admixture waves, can interpret left populations least n=1n = 1 streams ancestry set right populations. case, likely explanation Neandertal admixture non-Africans today.","code":"result <- qpWave(  left = c(\"French\", \"Sardinian\", \"Han\"),  right = c(\"Altai\", \"Yoruba\", \"Mbuti\"),  data = snps ) result"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"qpadm","dir":"Articles","previous_headings":"qpWave and qpAdm","what":"qpAdm","title":"Basic overview of the admixr package","text":"qpAdm method can used find, given target population, proportions ancestry coming set source populations. Importantly, since often lack accurate representatives true ancestral populations, can use set reference populations instead, crucial assumption references set phylogenetically closer true source populations set specified outgroups. example, coming back example estimating proportions Neandertal ancestry people today, define: set European individuals target; Vindija Neanderthal African two source populations; outgroup populations Chimp, Altai Neanderthal Denisovan (true ancestral populations specified sources). defined three population sets, can run qpAdm : qpAdm() function argument details (default TRUE) makes function return list three elements: proportions - data frame admixture proportions - mostly care ; ranks - results rank tests performed qpWave - evaluate well assumed traget-sources-outgroups population model match data; subsets - results “subsets” analysis (see documentation details. details set FALSE, proportions components returned qpAdm() function. Let’s start ranks element: row rank = 1 represents qpWave test nnsource populations set left set outgroups right set. test evaluates whether ancestral populations descended nn independent streams ancestry. case, n=2n = 2 (Mbuti Vindija), means data consistent rank r=1r = 1 satisfy inequality r+1≤nr + 1 \\le n proved Reich et al., 2012. see true three target populations (pp-value > 0.05 targets), simple model Neandertal admixture thus seems reasonably consistent data. rank = 2 row represents qpWave test adding target population left group together sources. test makes sure including target population increase rank f4f_4 matrix, meaning target can really modelled mixture ancestries sources. pp-values turn low, indicates assumed model fit data part ancestry target possibly traced sources. case, however, rank = 2 test pp-values significant, can reasonably sure target samples can fully modelled mixtures specified references. important element qpAdm output $proportions component. contains admixture proportion estimates specified sources, p-values model (remember, low p-values/significance means model rejected!) well standard errors proportions using block jackknife: compare result f4f_4-ratio values calculated , see qpAdm estimates close got earlier. third element list results shows outcome “subsets” analysis, involves testing subsets potential source populations. 1 “pattern” column means proportion ancestry particular source population (order specified user) forced 0.0. New feature: new function called qpAdm_rotation() allows exhaustive exploration many qpAdm models paralle. information please see vignette _“Fitting qpAdm models ‘rotation’ strategy_”.","code":"result <- qpAdm(   target = c(\"Sardinian\", \"Han\", \"French\"),   sources = c(\"Vindija\", \"Yoruba\"),   outgroups = c(\"Chimp\", \"Denisova\", \"Altai\"),   data = snps,   params = list(inbreed = \"YES\") # forced by new ADMIXTOOLS qpfstats ) result$ranks result$proportions result$subsets"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"grouping-samples","dir":"Articles","previous_headings":"","what":"Grouping samples","title":"Basic overview of the admixr package","text":"’ve far calculating statistics individual samples. However, often useful treat multiple samples single group population. admixr provides function called relabel() just . example: let’s say want run similar analysis one described DD statistic section, want treat Europeans, Africans archaics combined populations, separate individuals. ind file contain grouped labels - sample stands : merge several individual samples combined label can call relabel() like : can see function relabel returned modified EIGENSTRAT object, contains new item “modifiers” section - path new ind file. Let’s look contents: modified EIGENSTRAT object ready, can use “European”, “African” “Archaic” names admixr wrapper functions described . example: result, showing Europeans show genetic affinity archaic humans compared Africans today: Note d() function correctly picks “group modifier” ind file provided EIGENSTRAT object uses place original ind file.","code":"Chimp        U  Chimp Mbuti        U  Mbuti Yoruba       U  Yoruba Khomani_San  U  Khomani_San Han          U  Han Dinka        U  Dinka Sardinian    U  Sardinian Papuan       U  Papuan French       U  French Vindija      U  Vindija Altai        U  Altai Denisova     U  Denisova # paths to the original ind file and a new modified ind file, which will # contain merged population labels modif_snps <- relabel(   snps,   European = c(\"French\", \"Sardinian\"),   African = c(\"Dinka\", \"Yoruba\", \"Mbuti\", \"Khomani_San\"),   Archaic = c(\"Vindija\", \"Altai\", \"Denisova\") ) modif_snps #> EIGENSTRAT object #> ================= #> components: #>   ind file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind #>   snp file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp #>   geno file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno #>  #> modifiers: #>   groups:  /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/file2f8667c740a.ind Chimp        U  Chimp Mbuti        U  African Yoruba       U  African Khomani_San  U  African Han          U  Han Dinka        U  African Sardinian    U  European Papuan       U  Papuan French       U  European Vindija      U  Archaic Altai        U  Archaic Denisova     U  Archaic result <- d(W = \"European\", X = \"African\", Y = \"Archaic\", Z = \"Chimp\", data = modif_snps) head(result)"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"counting-presentmissing-snps","dir":"Articles","previous_headings":"","what":"Counting present/missing SNPs","title":"Basic overview of the admixr package","text":"count_snps function can useful quality control, weighting admixture statistics (DD, f4f_4, etc.) regression analyses etc. two optional arguments: prop - changes whether report SNP counts proportions (set FALSE default), missing - controls whether count missing SNPs instead present SNPs (set FALSE default). sample, count SNPs present sample:","code":"count_snps(snps)"},{"path":[]},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"filtering-based-on-a-bed-file","dir":"Articles","previous_headings":"Data filtering","what":"Filtering based on a BED file","title":"Basic overview of the admixr package","text":"quite common repeat particular analysis subset genome (intergenic sites, etc). However, EIGENSTRAT rather obscure file format generally supported standard bioinformatics tools. Luckily, admixr includes function filter_bed() takes EIGENSTRAT object BED file inputs produces new object contains modifier called “excluded”, linking snp file coordinates sites pass filtering excluded later analyses. want run whole analysis single pipeline, can use %>% pipe operator following: (%>% operator takes left side puts first argument function right side. takes time get used , useful longer multi-step “pipelines” makes pipelines much readable. fact, resulting code often reads almost like English! %>% pipe automatically imported load tidyverse library, can read .) formal definitions admixr function, data = always argument, don’t specify manually. Important: filter_bed() function makes easy filtering without worrying locations intermediate files, important keep mind function still creates temporary files hood. plan run many independent calculations filtered subset data, ’s better save new EIGENSTRAT object variable first re-use object multiple times, rather running whole pipeline analysis separately (create new copies intermediate files iteration).","code":"bed <- file.path(dirname(prefix), \"regions.bed\") # BED file contains regions to keep in an analysis new_snps <- filter_bed(snps, bed)  # BED file contains regions to remove from an analysis new_snps <- filter_bed(snps, bed, remove = TRUE) new_snps #> EIGENSTRAT object #> ================= #> components: #>   ind file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind #>   snp file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp #>   geno file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno #>  #> modifiers: #>   excluded sites:  /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/file2f866945bd49.snp  #>       (SNPs excluded: 100000, SNPs remaining: 400000) snps %>%   filter_bed(\"regions.bed\") %>%   d(W = \"French\", X = \"Mbuti\", Y = \"Vindija\", Z = \"Chimp\")"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"filtering-out-potential-ancient-dna-damage-snps","dir":"Articles","previous_headings":"Data filtering","what":"Filtering out potential ancient DNA damage SNPs","title":"Basic overview of the admixr package","text":"field ancient DNA, often need repeat analysis subset data less likely influenced ancient DNA damage, verify results caused artifacts data (due biochemical properties DNA degradation, ancient DNA damage lead increase C→T G→substitutions). Using similar method described BED filtering section , can use transversions_only() function generate snp file positions carry transitions (C→T G→sites): , combine several filtering steps one pipeline:","code":"new_snps <- transversions_only(snps)  # perform the calculation only on transversions d(W = \"French\", X = \"Dinka\", Y = \"Altai\", Z = \"Chimp\", data = new_snps) snps %>%                                    # take the original data   filter_bed(\"regions.bed\", remove = TRUE) %>%  # remove sites not in specified regions   transversions_only() %>%                      # remove potential false SNPs due to aDNA damage   d(W = \"French\", X = \"Dinka\", Y = \"Altai\", Z = \"Chimp\") # calculate D on the filtered dataset"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"merging-eigenstrat-datasets","dir":"Articles","previous_headings":"","what":"Merging EIGENSTRAT datasets","title":"Basic overview of the admixr package","text":"Another useful data processing function merge_eigenstrat(). function takes two EIGENSTRAT datasets merges , producing union samples intersection SNPs returning new EIGENSTRAT object.","code":"# this is just an example code - it will not run unless you specify the paths merged <- merge_eigenstrat(     merged = <\"prefix of the merged dataset\">     a = first_EIGENSTRAT_object,     b = second_EIGENSTRAT_object )"},{"path":"https://bodkan.net/slendr/articles/vignette-01-tutorial.html","id":"examining-log-information","dir":"Articles","previous_headings":"","what":"Examining log information","title":"Basic overview of the admixr package","text":"goal admixr abstract away low-level technical workings ADMIXTOOLS. saw examples , achieves dirty work parsing output files generated ADMIXTOOLS, presenting user convenient R data structures. Nevertheless, admixr (yet) parse information generated ADMIXTOOLS utilities. calculating D statistics, f4f_4 statistics simple analyses, single data frame usually user needs. However, sometimes things go wrong - turns data wrong format, ADMIXTOOLS crashes error results simply look suspicious. Furthermore, complex commands (qpAdm) yet completely implemented admixr. cases, still useful (important!) examine log outputs. admixr result, data frame object , contains (hidden!) attribute carries complete log file associate particular analysis: can examine full log D statistic run loginfo function. Without arguments, function writes complete log screen. Note run function data frame object although might appear contain information (’s normally hidden time ’s useful): situation bit complex qpAdm can evaluated multiple target populations/samples analyzed separately, analysis log file: case, either print log information (one log output target specified qpAdm call) runningloginfo(qpadm_res) , perhaps useful, specify target’s log file want examine: Finally, might want keep log files around future reference, debugging sharing others. purposes, can run loginfo function argument save = TRUE, potentially also specifying output directory (dir = \".\" default) prefix output file(s) (default prefix simply name admixr command generated log file). example, following save result qpAdm analysis Neandertal ancestry file prefix “qpAdm_Neandertal_ancestry”, just one Sardinian individual: create file current directory named qpAdm_Neandertal_ancestry_Sardinian.txt. Note call loginfo() qpAdm run, name target always added end output log file.  work licensed Creative Commons Attribution 4.0 International License.","code":"dres <- d(W = c(\"French\", \"Han\", \"Dinka\"), X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\", data = snps)  dres #> # A tibble: 3 × 10 #>   W      X      Y       Z           D  stderr Zscore  BABA  ABBA  nsnps #>   <chr>  <chr>  <chr>   <chr>   <dbl>   <dbl>  <dbl> <dbl> <dbl>  <dbl> #> 1 French Yoruba Vindija Chimp  0.0313 0.00693  4.51  15802 14844 487753 #> 2 Han    Yoruba Vindija Chimp  0.0278 0.00661  4.20  15780 14928 487925 #> 3 Dinka  Yoruba Vindija Chimp -0.0009 0.00612 -0.151 15131 15159 487667 loginfo(dres) #> Full output log of qpDstat: #> =================================================== #>  #> qpDstat: parameter file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpDstat__1658977312.par #> ### THE INPUT PARAMETERS #> ##PARAMETER NAME: VALUE #> genotypename: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno #> snpname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp #> indivname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind #> popfilename: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpDstat__1658977312.pop #> printsd: YES #> ## qpDstat version: 1152 #> inbreed set NO #> number of quadruples 3 locount: -1 hicount: 9999999 #>   0               French    1 #>   1                  Han    1 #>   2                Dinka    1 #>   3               Yoruba    1 #>   4              Vindija    1 #>   5                Chimp    1 #> jackknife block size:     0.050 #> snps: 500000  indivs: 6 #> number of blocks for block jackknife: 547 #> nrows, ncols: 6 500000 #> result:     French     Yoruba    Vindija      Chimp      0.0313      0.006933     4.510   15802  14844 487753  #> result:        Han     Yoruba    Vindija      Chimp      0.0278      0.006609     4.199   15780  14928 487925  #> result:      Dinka     Yoruba    Vindija      Chimp     -0.0009      0.006124    -0.151   15131  15159 487667  #> ##end of qpDstat:        1.655 seconds cpu        0.000 Mbytes in use qpadm_res <- qpAdm(   target = c(\"Sardinian\", \"Han\"),   sources = c(\"Vindija\", \"Yoruba\"),   outgroups = c(\"Chimp\", \"Denisova\", \"Altai\"),   data = snps,   params = list(inbreed = \"YES\") # forced by new ADMIXTOOLS qpfstats )  qpadm_res #> $proportions #> # A tibble: 2 × 8 #>   target    Vindija Yoruba stderr_Vindija stderr_Yoruba nsnps_used nsnps_target #>   <chr>       <dbl>  <dbl>          <dbl>         <dbl>      <dbl>        <dbl> #> 1 Sardinian   0.025  0.975          0.006         0.006     492420       499314 #> 2 Han         0.021  0.979          0.006         0.006     492531       499654 #> # ℹ 1 more variable: pvalue <dbl> #>  #> $ranks #> # A tibble: 4 × 8 #>   target     rank    df chisq  tail dfdiff chisqdiff taildiff #>   <chr>     <dbl> <dbl> <dbl> <dbl>  <dbl>     <dbl>    <dbl> #> 1 Sardinian     1     1 0.006 0.936      3    -0.006    1     #> 2 Sardinian     2     0 0     1          1     0.006    0.936 #> 3 Han           1     1 2.15  0.143      3    -2.15     1     #> 4 Han           2     0 0     1          1     2.15     0.143 #>  #> $subsets #> # A tibble: 6 × 8 #>   target    pattern    wt   dof     chisq     tail Vindija Yoruba #>   <chr>     <chr>   <dbl> <dbl>     <dbl>    <dbl>   <dbl>  <dbl> #> 1 Sardinian 00          0     1     0.006 0.936      0.025  0.975 #> 2 Sardinian 01          1     2 15966.    0          1      0     #> 3 Sardinian 10          1     2    16.6   0.000250   0      1     #> 4 Han       00          0     1     2.15  0.143      0.021  0.979 #> 5 Han       01          1     2 14977.    0          1      0     #> 6 Han       10          1     2    14.5   0.000722   0      1 loginfo(qpadm_res, target = \"Han\") #> Full output log of qpAdm for target 'Han': #> =================================================== #>  #> qpAdm: parameter file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpAdm__375682135.par #> ### THE INPUT PARAMETERS #> ##PARAMETER NAME: VALUE #> genotypename: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.geno #> snpname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.snp #> indivname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/snps/snps.ind #> popleft: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpAdm__375682135.popleft #> popright: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpAdm__375682135.popright #> inbreed: YES #> ##  qpAdm -p /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmpR95ENe/qpAdm__375682135.par #> ## qpAdm version: 2050 #> seed: 263150876 #> allsnps set NO.  It is recommended that allsnps be set explicitly #> inbreed set YES #>  #> left pops: #>                  Han      1 #>              Vindija      1 #>               Yoruba      1 #>  #> right pops: #>                Chimp      1 #>             Denisova      1 #>                Altai      1 #>  #> jackknife block size:     0.050 #> snps: 500000  indivs: 6 #> number of blocks for block jackknife: 547 #> ## ncols: 500000 #> coverage:                  Han 499654 #> coverage:              Vindija 497544 #> coverage:               Yoruba 499246 #> coverage:                Chimp 491273 #> coverage:             Denisova 497398 #> coverage:                Altai 497729 #> Effective number of blocks:   489.431 #> numsnps used: 492531 #> codimension 1 #> f4info:  #> f4rank: 1 dof:      1 chisq:     2.146 tail:          0.142947129 dofdiff:      3 chisqdiff:    -2.146 taildiff:                    1 #> B: #>           scale     1.000  #>        Denisova     0.475  #>           Altai     1.332  #> A: #>           scale    27.595  #>         Vindija     1.414  #>          Yoruba    -0.030  #>  #>  #> full rank #> f4info:  #> f4rank: 2 dof:      0 chisq:     0.000 tail:                    1 dofdiff:      1 chisqdiff:     2.146 taildiff:          0.142947129 #> B: #>           scale    19.566   749.540  #>        Denisova     0.470    -0.811  #>           Altai     1.334    -1.158  #> A: #>           scale     1.414     1.414  #>         Vindija     1.414     0.000  #>          Yoruba     0.000     1.414  #>  #>  #> best coefficients:     0.021     0.979  #> Jackknife mean:      0.020620157     0.979379843  #>       std. errors:     0.006     0.006  #>  #> error covariance (* 1,000,000) #>         34        -34  #>        -34         34  #>  #>  #> summ: Han    2      0.142947     0.021     0.979         34        -34         34  #>  #>     fixed pat  wt  dof     chisq       tail prob #>            00  0     1     2.146        0.142947     0.021     0.979  #>            01  1     2 14976.689               0     1.000     0.000  #>            10  1     2    14.467     0.000722035     0.000     1.000  #> best pat:           00         0.142947              -  - #> best pat:           10      0.000722035  chi(nested):    12.321 p-value for nested model:     0.000447908 #>  #> coeffs:     0.021     0.979  #>  #> ## dscore:: f_4(Base, Fit, Rbase, right2) #> ## genstat:: f_4(Base, Fit, right1, right2) #>  #> details:              Vindija             Denisova     0.024008   40.886793 #> details:               Yoruba             Denisova    -0.001082   -2.597265 #> dscore:             Denisova f4:    -0.000565 Z:    -1.367387 #>  #> details:              Vindija                Altai     0.068176  121.310982 #> details:               Yoruba                Altai    -0.001546   -3.726479 #> dscore:                Altai f4:    -0.000109 Z:    -0.265079 #>  #> gendstat:                Chimp             Denisova    -1.367 #> gendstat:                Chimp                Altai    -0.265 #> gendstat:             Denisova                Altai     1.132 #>  #> worst Z-score with right hand mix #> f4(Target, Fit, Base, mix of Right pops;  Z:    -1.465 sum:     1.000 #>                       Denisova     1.580 #>                          Altai    -0.580 #>  #> oldmode set: terminating #> ##end of qpAdm:        1.512 seconds cpu        0.000 Mbytes in use loginfo(qpadm_res, target = \"Sardinian\", save = TRUE, prefix = \"qpAdm_Neandertal_ancestry\")"},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Running qpAdm models with the 'rotation' strategy","text":"qpAdm model fitting complex topic. navigate successfuly requires solid knowledge ff-statistics theory first introduced Nick Patterson colleagues 2012. part tutorial, looked basic overview qpAdm-related functionality implemented admixr. also talked important resources learning powerful method pioneered Iosif Lazaridis 2015. Recently, Harney et al. published exciting paper called “Assessing Performance qpAdm: Statistical Tool Studying Population Admixture”. go , encourage everyone read superb tutorial/guide available supplementary PDF. really isn’t better source information run interpret qpAdm analyses. Please, attempt run qpAdm familiarized yoursef -mentioned resources. many people ask questions via email (qpAdm also topics) sensible answer - “read papers understand statistics first.” know ’s frustrating really shortcuts .","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"qpadm-rotation","dir":"Articles","previous_headings":"","what":"qpAdm “rotation”","title":"Running qpAdm models with the 'rotation' strategy","text":"ever worked qpAdm, well aware intricacies finding suitable set models can explain data. Among things, make decision number admixture sources populations appropriate surrogates source populations (rarely sampled directly). Furthermore, need carefully choose number called ‘outgroup’ populations (also called ‘references’ ‘right’ populations, depending talk ). mentioned paper Harney et al. described interesting idea find set appropriate models (.e. combinations source outgroup populations) sucessfully used past. call method “rotating population” strategy. approach starts defining set “candidate” populations iteratively sample defined number “sources” ancestry “target” population interest (commonly two three sources). removing sources candidate list, define remaining populations “outgroups”. Finally, iteratively fit qpAdm models combination target, sources outgroups, extracting pp-values statistics interest. finishing exhaustive fitting source-outgroup combinations, examine explored models, selecting seem appropriate.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"implementation-in-admixr","dir":"Articles","previous_headings":"","what":"Implementation in admixr","title":"Running qpAdm models with the 'rotation' strategy","text":"admixr, implemented function qpAdm_rotation() exactly described paragraph one additional feature. Given sensitivity qpAdm large numbers potential outgroups (references), combination sources outgroups also explore models possible subsets outgroups. find models small possible, possibly determining outgroups potentially redundant actually needed. Let’s say target population T set candidates potential sources outgroups C = {, b, c, d, e, f}. , imagine iteration rotation scheme fixed sources S = {, b}, remaining candidates outgroups C - S = {c, d, e, f}. basic implementation rotation procedure simply take C - S full set outgroups fitted following model: model #1: target T, sources S = {, b} outgroups = {c, d, e, f} However, admixr, evaluate following models addition model #1: model #2: target T, sources S = {, b} outgroups = {c, d, e} model #3: target T, sources S = {, b} outgroups = {c, d, f} model #4: target T, sources S = {, b} outgroups = {c, e, f} model #5: target T, sources S = {, b} outgroups = {d, e, f}. Therefore, implementation qpAdm_rotation() explores posible outgroup combinations, allowing us look smallest model (terms outgroup size) can explain data.","code":""},{"path":[]},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"performing-exhaustive-search-by-rotating-sourcesoutgroups","dir":"Articles","previous_headings":"Concrete example","what":"Performing exhaustive search by rotating sources/outgroups","title":"Running qpAdm models with the 'rotation' strategy","text":"example, let’s revisit problem estimating level Neandertal ancestry French person main tutorial. use illustration : ’s simplest possible analysis one qpAdm. gives us clear expectation “truth” . gives us clear expectation models definitely reject. First, let’s download install development version admixr get access new features, download small example data set: individuals genotype data: qpAdm_rotation() function simple. accepts: name target population, list candidate populations, logical parameter minimize, determining whether perform “minimization” outgroup size described previous section, assumed number sources ancestry, number CPU cores use analysis (careful options many ADMIXTOOLS analyses run parallel can consume lot memory!), parameter fulloutput specifying whether want “ranks” “subsets/patterns” statistics (see main tutorial information) just want proportions ancestry significance values individual models (default, .e. fulloutput = FALSE). , let’s say interested finding proportions archaic human ancestry French individual, also want see sorts possible models find match archaic introgression. run following: full output looks like: can see list three components, expect qpAdm() run (, see manual page tutorial description three elements meaning). first column component always named model - contains short identifier individual “rotation” run (.e., combination target & sources & outgroups). ’s values don’t particular meaning - order completely arbitrary!, variable useful later filtering examination individual models detail. Let’s ignore $ranks $subsets elements now. focus first element, $proportions contains main qpAdm summary.","code":"library(admixr)  snps <- eigenstrat(download_data(dirname = tempdir())) read_ind(snps) #> # A tibble: 12 × 3 #>    id          sex   label       #>    <chr>       <chr> <chr>       #>  1 Chimp       U     Chimp       #>  2 Mbuti       U     Mbuti       #>  3 Yoruba      U     Yoruba      #>  4 Khomani_San U     Khomani_San #>  5 Han         U     Han         #>  6 Dinka       U     Dinka       #>  7 Sardinian   U     Sardinian   #>  8 Papuan      U     Papuan      #>  9 French      U     French      #> 10 Vindija     U     Vindija     #> 11 Altai       U     Altai       #> 12 Denisova    U     Denisova models <- qpAdm_rotation(     data = snps,     target = \"French\",     candidates = c(\"Dinka\", \"Mbuti\", \"Yoruba\", \"Vindija\", \"Altai\", \"Denisova\", \"Chimp\"),     minimize = TRUE,     nsources = 2,     ncores = 2,     fulloutput = TRUE ) models #> $proportions #> # A tibble: 336 × 13 #>    model target source1 source2 outgroups    noutgroups  pvalue    prop1   prop2 #>    <chr> <chr>  <chr>   <chr>   <chr>             <int>   <dbl>    <dbl>   <dbl> #>  1 m1    French Dinka   Mbuti   Yoruba & Vi…          3 3.87e-2    0.757   0.243 #>  2 m2    French Dinka   Mbuti   Yoruba & Vi…          3 1.55e-2    0.774   0.226 #>  3 m3    French Dinka   Mbuti   Yoruba & Vi…          3 3.49e-7    0.895   0.105 #>  4 m4    French Dinka   Mbuti   Yoruba & Al…          3 6.83e-2    0.781   0.219 #>  5 m5    French Dinka   Mbuti   Yoruba & Al…          3 6.59e-6    0.892   0.108 #>  6 m6    French Dinka   Mbuti   Yoruba & De…          3 3.99e-3    0.89    0.11  #>  7 m7    French Dinka   Mbuti   Vindija & A…          3 6.69e-2   -8.09    9.09  #>  8 m8    French Dinka   Mbuti   Vindija & A…          3 4.64e-1   45.9   -44.9   #>  9 m9    French Dinka   Mbuti   Vindija & D…          3 1.88e-1 -180.    181.    #> 10 m10   French Dinka   Mbuti   Altai & Den…          3 1.33e-1  -37.8    38.8   #> # ℹ 326 more rows #> # ℹ 4 more variables: stderr1 <dbl>, stderr2 <dbl>, nsnps_used <dbl>, #> #   nsnps_target <dbl> #>  #> $ranks #> # A tibble: 672 × 9 #>    model target  rank    df chisq        tail dfdiff chisqdiff    taildiff #>    <chr> <chr>  <dbl> <dbl> <dbl>       <dbl>  <dbl>     <dbl>       <dbl> #>  1 m1    French     1     1  4.27 0.0387           3     -4.27 1           #>  2 m1    French     2     0  0    1                1      4.27 0.0387      #>  3 m10   French     1     1  5.86 0.0155           3     -5.86 1           #>  4 m10   French     2     0  0    1                1      5.86 0.0155      #>  5 m100  French     1     1 26.0  0.000000349      3    -26.0  1           #>  6 m100  French     2     0  0    1                1     26.0  0.000000349 #>  7 m101  French     1     1  3.32 0.0683           3     -3.32 1           #>  8 m101  French     2     0  0    1                1      3.32 0.0683      #>  9 m102  French     1     1 20.3  0.00000659       3    -20.3  1           #> 10 m102  French     2     0  0    1                1     20.3  0.00000659  #> # ℹ 662 more rows #>  #> $subsets #> # A tibble: 1,008 × 12 #>    model target source1 source2 pattern    wt   dof  chisq      tail prop1 prop2 #>    <chr> <chr>  <chr>   <chr>   <chr>   <dbl> <dbl>  <dbl>     <dbl> <dbl> <dbl> #>  1 m1    French Dinka   Mbuti   00          0     1   4.27   3.87e-2 0.757 0.243 #>  2 m1    French Dinka   Mbuti   01          1     2  23.5    7.87e-6 1     0     #>  3 m1    French Dinka   Mbuti   10          1     2 160.     0       0     1     #>  4 m10   French Dinka   Mbuti   00          0     1   5.86   1.55e-2 0.774 0.226 #>  5 m10   French Dinka   Mbuti   01          1     2  23.1    9.50e-6 1     0     #>  6 m10   French Dinka   Mbuti   10          1     2 162.     0       0     1     #>  7 m100  French Dinka   Mbuti   00          0     1  26.0    3.49e-7 0.895 0.105 #>  8 m100  French Dinka   Mbuti   01          1     2  30.6    2.22e-7 1     0     #>  9 m100  French Dinka   Mbuti   10          1     2 287.     0       0     1     #> 10 m101  French Dinka   Mbuti   00          0     1   3.32   6.83e-2 0.781 0.219 #> # ℹ 998 more rows #> # ℹ 1 more variable: comment <chr>"},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"examining-and-filtering-fitted-models","dir":"Articles","previous_headings":"Concrete example","what":"Examining and filtering fitted models","title":"Running qpAdm models with the 'rotation' strategy","text":"$proportions table shown contains information models, regardless plausibility. can see examining distributions p-values (column pvalue) admixture proportions (columns prop1 prop2) evaluated model figure . Notice two things (dot represents one examined qpAdm model): Many models inferred admixture proportions way outside [0, 1] interval - clearly nonsensical. Many models low p-values - means incompatible data can rejected.  make easier narrow list models, admixr package contains function qpAdm_filter(). function accepts result qpAdm_rotation() function (either fulloutput = TRUE version simple data frame admixture proportions, p-values etc. produced usingfulloutput = FALSE) filters models proportions outside [0, 1] range p-values lower specified cutoff (0.05 default): can verify filtering worked visualizing filtered set models . Note p-values distributed across range “insigificance” (.e., “non-rejection”) [0.05, 1.0]. Furthermore - remember originally set find combinations sources-outgroups model archaic ancestry French individual? can clearly see two tidy clusters estimated ancestry proportions. One small (corresponds Neandertal component modern humans - expect 2-3% based many previous analyses) one large (“modern human” component, non-Neandertal ancestry):  Let’s now focus proportions table. also ignore couple columns brevity. Note now also completely ignoring p-values used model selection - statistically meaningful stage! Higher p-value never implies higher likelihood model. Finally, order models based size outgroup set (smaller models first): Fun fact: notice table many models chimpanzee fitted source ancestry! Interestingly, qpAdm used Chimp infer archaic human ancestry. think Neandertal ancestry “ancestral component” modern human genome qpAdm rotation procedure therefore concludes Chimpanzee unreasonable surrogate source population. course, know better sources candidates set - archaic humans! Another interesting fact: notice rotating population procedure selected another plausible model characterizing ancestry French individual. However, course doesn’t represent Neandertal introgression. might possibly represent left exercise reader… :)","code":"library(dplyr) library(tidyr) library(ggplot2)  select(models$proportions, model, pvalue, prop1, prop2) %>%     gather(parameter, value, -model) %>%     ggplot(aes(parameter, value)) +     geom_jitter() +     facet_wrap(~ parameter, scales = \"free\") # filter out models which can clearly be rejected fits <- qpAdm_filter(models) select(fits$proportions, model, pvalue, prop1, prop2) %>%     gather(parameter, value, -model) %>%     ggplot(aes(parameter, value)) +     geom_jitter() +     facet_wrap(~ parameter, scales = \"free\") +     coord_cartesian(y = c(0, 1)) props <- fits$proportions %>%     arrange(noutgroups) %>%     select(-c(target, noutgroups, stderr1, stderr2, nsnps_used, nsnps_target))  print(props, n = Inf) #> # A tibble: 51 × 7 #>    model source1 source2  outgroups                           pvalue prop1 prop2 #>    <chr> <chr>   <chr>    <chr>                                <dbl> <dbl> <dbl> #>  1 m40   Dinka   Vindija  Yoruba & Altai & Chimp              0.943  0.975 0.025 #>  2 m81   Dinka   Chimp    Mbuti & Yoruba & Vindija            0.871  0.938 0.062 #>  3 m183  Yoruba  Vindija  Mbuti & Altai & Denisova            0.838  0.993 0.007 #>  4 m52   Dinka   Altai    Mbuti & Vindija & Denisova          0.830  0.977 0.023 #>  5 m82   Dinka   Chimp    Mbuti & Yoruba & Altai              0.787  0.943 0.057 #>  6 m56   Dinka   Altai    Yoruba & Vindija & Chimp            0.785  0.972 0.028 #>  7 m65   Dinka   Denisova Mbuti & Yoruba & Vindija            0.742  0.96  0.04  #>  8 m66   Dinka   Denisova Mbuti & Yoruba & Altai              0.701  0.963 0.037 #>  9 m55   Dinka   Altai    Yoruba & Vindija & Denisova         0.587  0.974 0.026 #> 10 m83   Dinka   Chimp    Mbuti & Yoruba & Denisova           0.576  0.96  0.04  #> 11 m50   Dinka   Altai    Mbuti & Yoruba & Denisova           0.574  0.973 0.027 #> 12 m34   Dinka   Vindija  Mbuti & Yoruba & Denisova           0.573  0.973 0.027 #> 13 m199  Yoruba  Altai    Mbuti & Vindija & Denisova          0.572  0.99  0.01  #> 14 m36   Dinka   Vindija  Mbuti & Altai & Denisova            0.563  0.979 0.021 #> 15 m49   Dinka   Altai    Mbuti & Yoruba & Vindija            0.536  0.975 0.025 #> 16 m33   Dinka   Vindija  Mbuti & Yoruba & Altai              0.513  0.977 0.023 #> 17 m41   Dinka   Vindija  Yoruba & Denisova & Chimp           0.442  0.969 0.031 #> 18 m37   Dinka   Vindija  Mbuti & Altai & Chimp               0.436  0.978 0.022 #> 19 m57   Dinka   Altai    Yoruba & Denisova & Chimp           0.434  0.969 0.031 #> 20 m233  Yoruba  Chimp    Mbuti & Altai & Denisova            0.388  0.987 0.013 #> 21 m58   Dinka   Altai    Vindija & Denisova & Chimp          0.361  0.972 0.028 #> 22 m39   Dinka   Vindija  Yoruba & Altai & Denisova           0.359  0.977 0.023 #> 23 m35   Dinka   Vindija  Mbuti & Yoruba & Chimp              0.350  0.98  0.02  #> 24 m67   Dinka   Denisova Mbuti & Yoruba & Chimp              0.350  0.981 0.019 #> 25 m51   Dinka   Altai    Mbuti & Yoruba & Chimp              0.348  0.98  0.02  #> 26 m53   Dinka   Altai    Mbuti & Vindija & Chimp             0.300  0.975 0.025 #> 27 m42   Dinka   Vindija  Altai & Denisova & Chimp            0.233  0.976 0.024 #> 28 m38   Dinka   Vindija  Mbuti & Denisova & Chimp            0.227  0.975 0.025 #> 29 m54   Dinka   Altai    Mbuti & Denisova & Chimp            0.221  0.975 0.025 #> 30 m232  Yoruba  Chimp    Mbuti & Vindija & Denisova          0.121  0.984 0.016 #> 31 m202  Yoruba  Altai    Vindija & Denisova & Chimp          0.0988 0.974 0.026 #> 32 m68   Dinka   Denisova Mbuti & Vindija & Altai             0.0790 0.963 0.037 #> 33 m71   Dinka   Denisova Yoruba & Vindija & Altai            0.0770 0.96  0.04  #> 34 m215  Yoruba  Denisova Mbuti & Vindija & Altai             0.0742 0.987 0.013 #> 35 m4    Dinka   Mbuti    Yoruba & Altai & Denisova           0.0683 0.781 0.219 #> 36 m186  Yoruba  Vindija  Altai & Denisova & Chimp            0.0507 0.978 0.022 #> 37 m59   Dinka   Altai    Mbuti & Yoruba & Vindija & Denisova 0.792  0.975 0.025 #> 38 m63   Dinka   Altai    Yoruba & Vindija & Denisova & Chimp 0.649  0.973 0.027 #> 39 m43   Dinka   Vindija  Mbuti & Yoruba & Altai & Denisova   0.628  0.977 0.023 #> 40 m44   Dinka   Vindija  Mbuti & Yoruba & Altai & Chimp      0.611  0.977 0.023 #> 41 m60   Dinka   Altai    Mbuti & Yoruba & Vindija & Chimp    0.524  0.974 0.026 #> 42 m62   Dinka   Altai    Mbuti & Vindija & Denisova & Chimp  0.479  0.975 0.025 #> 43 m47   Dinka   Vindija  Yoruba & Altai & Denisova & Chimp   0.468  0.976 0.024 #> 44 m46   Dinka   Vindija  Mbuti & Altai & Denisova & Chimp    0.441  0.978 0.022 #> 45 m45   Dinka   Vindija  Mbuti & Yoruba & Denisova & Chimp   0.433  0.974 0.026 #> 46 m61   Dinka   Altai    Mbuti & Yoruba & Denisova & Chimp   0.425  0.974 0.026 #> 47 m75   Dinka   Denisova Mbuti & Yoruba & Vindija & Altai    0.187  0.962 0.038 #> 48 m93   Dinka   Chimp    Mbuti & Yoruba & Altai & Denisova   0.0948 0.955 0.045 #> 49 m91   Dinka   Chimp    Mbuti & Yoruba & Vindija & Altai    0.0873 0.942 0.058 #> 50 m64   Dinka   Altai    Mbuti & Yoruba & Vindija & Denisov… 0.634  0.974 0.026 #> 51 m48   Dinka   Vindija  Mbuti & Yoruba & Altai & Denisova … 0.558  0.977 0.023 filter(props, source1 == \"Chimp\" | source2 == \"Chimp\") #> # A tibble: 7 × 7 #>   model source1 source2 outgroups                         pvalue prop1 prop2 #>   <chr> <chr>   <chr>   <chr>                              <dbl> <dbl> <dbl> #> 1 m81   Dinka   Chimp   Mbuti & Yoruba & Vindija          0.871  0.938 0.062 #> 2 m82   Dinka   Chimp   Mbuti & Yoruba & Altai            0.787  0.943 0.057 #> 3 m83   Dinka   Chimp   Mbuti & Yoruba & Denisova         0.576  0.96  0.04  #> 4 m233  Yoruba  Chimp   Mbuti & Altai & Denisova          0.388  0.987 0.013 #> 5 m232  Yoruba  Chimp   Mbuti & Vindija & Denisova        0.121  0.984 0.016 #> 6 m93   Dinka   Chimp   Mbuti & Yoruba & Altai & Denisova 0.0948 0.955 0.045 #> 7 m91   Dinka   Chimp   Mbuti & Yoruba & Vindija & Altai  0.0873 0.942 0.058 filter(props, prop1 < 0.9, prop2 < 0.9) #> # A tibble: 1 × 7 #>   model source1 source2 outgroups                 pvalue prop1 prop2 #>   <chr> <chr>   <chr>   <chr>                      <dbl> <dbl> <dbl> #> 1 m4    Dinka   Mbuti   Yoruba & Altai & Denisova 0.0683 0.781 0.219"},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"Running qpAdm models with the 'rotation' strategy","text":"stage analysis, decide models produced qpAdm_filter() immediately rejected reasonable others . Possibly based prior knowledge additional statistics (details information available full log output information shown loginfo()). say qpAdm methodology, rooted strong statistics, certain point much art science. Interpreting results finding appropriate models can quite challenge. Happy modeling please, let know discover bugs missing features. goal tool streamline qpAdm model fitting much possible can input.","code":""},{"path":"https://bodkan.net/slendr/articles/vignette-02-qpAdm.html","id":"final-remarks","dir":"Articles","previous_headings":"","what":"Final remarks","title":"Running qpAdm models with the 'rotation' strategy","text":"reminder, keep mind admixr gives tools filtering SNPs also grouping samples populations fly! can easily process group samples plugging qpAdm_rotation()! Also note can use function loginfo() examine complete log output model specifying model identifier. helpful debugging purposes also cases need particular statistic full qpAdm log report currently parsed admixr:","code":"loginfo(fits, \"m40\") #> Full output log of qpAdm rotation for model 'm40': #> =================================================== #>  #> qpAdm: parameter file: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/qpAdm__1758491977.par #> ### THE INPUT PARAMETERS #> ##PARAMETER NAME: VALUE #> genotypename: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/snps/snps.geno #> snpname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/snps/snps.snp #> indivname: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/snps/snps.ind #> popleft: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/qpAdm__1758491977.popleft #> popright: /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/qpAdm__1758491977.popright #> ##  qpAdm -p /var/folders/lq/bl36db_s6w908hnjkntdp4140000gn/T//RtmptyusSo/qpAdm__1758491977.par #> ## qpAdm version: 2050 #> seed: 808545690 #> allsnps set NO.  It is recommended that allsnps be set explicitly #>  *** recommended that inbreed be explicitly set *** #> inbreed set NO #>  #> left pops: #>               French      1 #>                Dinka      1 #>              Vindija      1 #>  #> right pops: #>               Yoruba      1 #>                Altai      1 #>                Chimp      1 #>  #> jackknife block size:     0.050 #> snps: 500000  indivs: 6 #> number of blocks for block jackknife: 547 #> ## ncols: 500000 #> coverage:               French 499434 #> coverage:                Dinka 499362 #> coverage:              Vindija 497544 #> coverage:               Yoruba 499246 #> coverage:                Altai 497729 #> coverage:                Chimp 491273 #> Effective number of blocks:   489.461 #> numsnps used: 492145 #> codimension 1 #> f4info:  #> f4rank: 1 dof:      1 chisq:     0.005 tail:          0.943006656 dofdiff:      3 chisqdiff:    -0.005 taildiff:                    1 #> B: #>           scale     1.000  #>           Altai     1.299  #>           Chimp     0.560  #> A: #>           scale    15.336  #>           Dinka    -0.037  #>         Vindija     1.414  #>  #>  #> full rank #> f4info:  #> f4rank: 2 dof:      0 chisq:     0.000 tail:                    1 dofdiff:      1 chisqdiff:     0.005 taildiff:          0.943006656 #> B: #>           scale   418.012    10.844  #>           Altai    -1.297     1.299  #>           Chimp    -0.564     0.560  #> A: #>           scale     1.414     1.414  #>           Dinka     1.414     0.000  #>         Vindija     0.000     1.414  #>  #>  #> best coefficients:     0.975     0.025  #> Jackknife mean:      0.974726215     0.025273785  #>       std. errors:     0.005     0.005  #>  #> error covariance (* 1,000,000) #>         25        -25  #>        -25         25  #>  #>  #> summ: French    2      0.943007     0.975     0.025         25        -25         25  #>  #>     fixed pat  wt  dof     chisq       tail prob #>            00  0     1     0.005        0.943007     0.975     0.025  #>            01  1     2    25.213     3.35003e-06     1.000     0.000  #>            10  1     2 23591.722               0     0.000     1.000  #> best pat:           00         0.943007              -  - #> best pat:           01      3.35003e-06  chi(nested):    25.208 p-value for nested model:     5.14691e-07 #>  #> coeffs:     0.975     0.025  #>  #> ## dscore:: f_4(Base, Fit, Rbase, right2) #> ## genstat:: f_4(Base, Fit, right1, right2) #>  #> details:                Dinka                Altai    -0.003103   -4.440509 #> details:              Vindija                Altai     0.119761  147.146084 #> dscore:                Altai f4:     0.000001 Z:     0.001491 #>  #> details:                Dinka                Chimp    -0.001349   -2.261712 #> details:              Vindija                Chimp     0.051628   78.030237 #> dscore:                Chimp f4:    -0.000010 Z:    -0.017670 #>  #> gendstat:               Yoruba                Altai     0.001 #> gendstat:               Yoruba                Chimp    -0.018 #> gendstat:                Altai                Chimp    -0.029 #>  #> worst Z-score with right hand mix #> f4(Target, Fit, Base, mix of Right pops;  Z:    -0.033 sum:     1.000 #>                          Altai    -2.544 #>                          Chimp     3.544 #>  #> oldmode set: terminating #> ##end of qpAdm:        1.523 seconds cpu        0.000 Mbytes in use"},{"path":"https://bodkan.net/slendr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Martin Petr. Author, maintainer.","code":""},{"path":"https://bodkan.net/slendr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Petr M (2025). admixr: Interface Software Package 'ADMIXTOOLS'. R package version 0.9.2.9000, https://github.com/bodkan/admixr.","code":"@Manual{,   title = {admixr: An Interface for the Software Package 'ADMIXTOOLS'},   author = {Martin Petr},   year = {2025},   note = {R package version 0.9.2.9000},   url = {https://github.com/bodkan/admixr}, }"},{"path":[]},{"path":"https://bodkan.net/slendr/index.html","id":"what-is-admixr","dir":"","previous_headings":"","what":"What is admixr?","title":"An Interface for the Software Package ADMIXTOOLS","text":"admixr package provides convenient R interface ADMIXTOOLS, widely used software package calculating admixture statistics testing population admixture hypotheses. typical ADMIXTOOLS workflow often involves combination sed/awk/shell scripting manual editing create different configuration files. passed command-line arguments one ADMIXTOOLS commands, control run particular analysis. results computation usually redirected another file, needs parsed user extract values interest, often using command-line utilities manual copy-pasting, finally analysed R, Excel another program. workflow can little cumbersome, especially one wants explore many hypotheses involving different combinations populations data filtering strategies. importantly, makes difficult follow rules best practice reproducible science, especially given need manual intervention command-line custom shell scripting orchestrate complex pipelines. admixr makes possible perform stages ADMIXTOOLS analysis entirely R. provides set convenient functions completely remove need “low-level” configuration individual ADMIXTOOLS programs, allowing users focus analysis .","code":""},{"path":"https://bodkan.net/slendr/index.html","id":"citing-admixr","dir":"","previous_headings":"","what":"Citing admixr","title":"An Interface for the Software Package ADMIXTOOLS","text":"admixr now published Application Note journal Bioinformatics. use work, please cite paper! join excellent company papers used amazing research. 🙂 Petr Martin; Vernot Benjamin; Kelso Janet. admixr—R package reproducible analyses using ADMIXTOOLS. Bioinformatics, Volume 35, Issue 17 (2019), pages 3194–3195. doi: 10.1093/bioinformatics/btz030. Citations help justify development fixing bugs! Thank ! 🖤","code":""},{"path":[]},{"path":"https://bodkan.net/slendr/index.html","id":"latest-stable-version","dir":"","previous_headings":"Installation instructions","what":"Latest stable version","title":"An Interface for the Software Package ADMIXTOOLS","text":"package available CRAN. can install simply running R session. recommended procedure users.","code":"install.packages(\"admixr\")"},{"path":"https://bodkan.net/slendr/index.html","id":"development-version","dir":"","previous_headings":"Installation instructions","what":"Development version","title":"An Interface for the Software Package ADMIXTOOLS","text":"install development version Github (might slightly ahead terms new features bugfixes compared stable release CRAN), need R package devtools. can run:","code":"install.packages(\"devtools\") devtools::install_github(\"bodkan/admixr\")"},{"path":"https://bodkan.net/slendr/index.html","id":"installing-admixtools","dir":"","previous_headings":"Installation instructions","what":"Installing ADMIXTOOLS","title":"An Interface for the Software Package ADMIXTOOLS","text":"order use admixr package, need working installation ADMIXTOOLS. can find installation instructions . Furthermore, also need make sure R can find ADMIXTOOLS binaries $PATH. can achieve specifying PATH=<path location ADMIXTOOLS programs> .Renviron file home directory. R find ADMIXTOOLS utilities, get warning upon loading library(admixr) R session. terms version ADMIXTOOLS required admixr, formal requirement. However, please note package generally developed tested latest ADMIXTOOLS release (currently version 8.0.2).","code":""},{"path":"https://bodkan.net/slendr/index.html","id":"browser-based-rstudio-session","dir":"","previous_headings":"Installation instructions","what":"Browser-based RStudio session","title":"An Interface for the Software Package ADMIXTOOLS","text":"can try admixr without installation directly browser! Simply click  short moment get Binder RStudio session running web browser. However, please note Binder’s computational resources extremely limited might run issues try run extremely resource-intensive computations.","code":""},{"path":"https://bodkan.net/slendr/index.html","id":"example-workflow","dir":"","previous_headings":"","what":"Example workflow","title":"An Interface for the Software Package ADMIXTOOLS","text":"code need compute DD statistic using ADMIXTOOLS admixr package! shell scripting, copy-pasting manual editing text files. thing need working ADMIXTOOLS installation path EIGENSTRAT data (trio ind/snp/geno files), call prefix . Note single call d function generates required intermediate config population files, runs ADMIXTOOLS, parses log output returns result data.frame object D statistics results. behind scenes, without user deal low-level technical details.","code":"library(admixr)  # download a small testing dataset to a temporary directory and process it for use in R snp_data <- eigenstrat(download_data())  result <- d(   W = c(\"French\", \"Sardinian\"), X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\",   data = snp_data )  result"},{"path":"https://bodkan.net/slendr/index.html","id":"more-information","dir":"","previous_headings":"","what":"More information","title":"An Interface for the Software Package ADMIXTOOLS","text":"see many examples admixr action, please check tutorial vignette.","code":""},{"path":"https://bodkan.net/slendr/index.html","id":"is-admixr-related-to-admixtools-2","dir":"","previous_headings":"","what":"Is admixr related to ADMIXTOOLS 2?","title":"An Interface for the Software Package ADMIXTOOLS","text":"Recently, new R package called ADMIXTOOLS 2 appeared horizon, offering re-implementation several features original ADMIXTOOLS suite command-line programs. admixr project related initiative. pre-cursor , superseeded . never used ADMIXTOOLS 2 , looks seems offer interesting features fitting complex admixture graphs, certainly something admixr . bottom-line : long original ADMIXTOOLS continues developed maintained, admixr remains relevant useful continue supported. ADMIXTOOLS one battle-tested pieces software population genetics—’re happy set features provides ’re happy admixr , real reason move away either .","code":""},{"path":"https://bodkan.net/slendr/reference/count_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"Count the number/proportion of present/missing sites in each sample — count_snps","title":"Count the number/proportion of present/missing sites in each sample — count_snps","text":"Count number/proportion present/missing sites sample","code":""},{"path":"https://bodkan.net/slendr/reference/count_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count the number/proportion of present/missing sites in each sample — count_snps","text":"","code":"count_snps(data, missing = FALSE, prop = FALSE)"},{"path":"https://bodkan.net/slendr/reference/count_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count the number/proportion of present/missing sites in each sample — count_snps","text":"data EIGENSTRAT data object. missing Count present SNPs missing SNPs? prop Calculate proportion instead counts?","code":""},{"path":"https://bodkan.net/slendr/reference/count_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count the number/proportion of present/missing sites in each sample — count_snps","text":"data.frame object SNP counts/proportions.","code":""},{"path":"https://bodkan.net/slendr/reference/count_snps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count the number/proportion of present/missing sites in each sample — count_snps","text":"","code":"if (FALSE) snps <- eigenstrat(download_data(dirname = tempdir()))  present_count <- count_snps(snps) #> Error: object 'snps' not found missing_count <- count_snps(snps, missing = TRUE) #> Error: object 'snps' not found  present_proportion <- count_snps(snps, prop = TRUE) #> Error: object 'snps' not found missing_proportion <- count_snps(snps, missing = TRUE, prop = TRUE) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/download_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Download example SNP data. — download_data","title":"Download example SNP data. — download_data","text":"data downloaded temporary directory default.","code":""},{"path":"https://bodkan.net/slendr/reference/download_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download example SNP data. — download_data","text":"","code":"download_data(dirname = tempdir())"},{"path":"https://bodkan.net/slendr/reference/download_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download example SNP data. — download_data","text":"dirname Directory put data (EIGENSTRAT trio snp/geno/ind files).","code":""},{"path":"https://bodkan.net/slendr/reference/eigenstrat.html","id":null,"dir":"Reference","previous_headings":"","what":"EIGENSTRAT data constructor — eigenstrat","title":"EIGENSTRAT data constructor — eigenstrat","text":"function creates instance EIGENSTRAT S3 class, encapsulates paths data files required ADMIXTOOLS analysis.","code":""},{"path":"https://bodkan.net/slendr/reference/eigenstrat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EIGENSTRAT data constructor — eigenstrat","text":"","code":"eigenstrat(prefix = NULL, ind = NULL, snp = NULL, geno = NULL, exclude = NULL)"},{"path":"https://bodkan.net/slendr/reference/eigenstrat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"EIGENSTRAT data constructor — eigenstrat","text":"prefix Shared path EIGENSTRAT trio (set ind/snp/geno files). ind, snp, geno Paths individual EIGENSTRAT components. exclude Pre-defined snp file excluded sites.","code":""},{"path":"https://bodkan.net/slendr/reference/eigenstrat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"EIGENSTRAT data constructor — eigenstrat","text":"S3 object EIGENSTRAT class.","code":""},{"path":"https://bodkan.net/slendr/reference/eigenstrat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"EIGENSTRAT data constructor — eigenstrat","text":"","code":"if (FALSE) # download an example genomic data and get the path prefix to the # trio of snp/geno/ind files in an EIGENSTRAT format prefix <- download_data(dirname = tempdir())  # wrap the trio of snp/geno/ind files in an object of the class # EIGENSTRAT snps <- eigenstrat(prefix) #> Error: object 'prefix' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/f4ratio.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","title":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","text":"Calculate D, f4, f4-ratio, f3 statistic.","code":""},{"path":"https://bodkan.net/slendr/reference/f4ratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","text":"","code":"f4ratio(data, X, A, B, C, O, outdir = NULL, params = NULL)  d(   data,   W,   X,   Y,   Z,   quartets = NULL,   outdir = NULL,   f4mode = FALSE,   params = NULL )  f4(data, W, X, Y, Z, quartets = NULL, outdir = NULL, params = NULL)  f3(data, A, B, C, outdir = NULL, inbreed = FALSE, params = NULL)"},{"path":"https://bodkan.net/slendr/reference/f4ratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","text":"data EIGENSTRAT data object. outdir put generated files (temporary directory default). params Named list parameters values. instance, params = list(allsnps = \"YES\") params = list(blgsize = 0.01) (arbitrary combination parameters using list multiple named elements). W, X, Y, Z, , B, C, O Population names according nomenclature used Patterson et al., 2012. quartets List character vectors (quartets population/sample labels) f4mode Calculate f4 statistic instead D statistic. inbreed See README.3PopTest ADMIXTOOLS explanation.","code":""},{"path":"https://bodkan.net/slendr/reference/f4ratio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","text":"Data frame object calculated statistics","code":""},{"path":"https://bodkan.net/slendr/reference/f4ratio.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the D, f4, f4-ratio, or f3 statistic. — f4ratio","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # define a set of populations to analyze pops <- c(\"French\", \"Sardinian\", \"Han\", \"Papuan\", \"Dinka\")  result_f4ratio <- f4ratio(     X = pops, A = \"Altai\", B = \"Vindija\", C = \"Yoruba\", O = \"Chimp\",     data = snps ) #> Error: object 'snps' not found  result_d <- d(     W = pops, X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\",     data = snps ) #> Error: object 'snps' not found  result_f4 <- f4(     W = pops, X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\",     data = snps ) #> Error: object 'snps' not found  result_f3 <- f3(     A = pops, B = \"Mbuti\", C = \"Khomani_San\",     data = snps ) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter EIGENSTRAT data based on a given BED file — filter_bed","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"Keep (discard) SNPs overlap (lie outside ) regions given BED file.","code":""},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"","code":"filter_bed(   data,   bed,   remove = FALSE,   outfile = tempfile(fileext = \".snp\"),   bedtools_args = \"\" )"},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"data EIGENSTRAT data object. bed Path BED file. remove Remove sites falling inside BED file regions? default, sites overlap BED regions removed. outfile Path output snp file coordinates excluded sites. bedtools_args Optional arguments `bedtools intersect` \"-sorted\" \"-sorted -nonamecheck\".","code":""},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"Updated S3 EIGENSTRAT data object.","code":""},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"function requires functioning bedtools installation! See: - https://github.com/arq5x/bedtools2 - https://bedtools.readthedocs.io/","code":""},{"path":"https://bodkan.net/slendr/reference/filter_bed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter EIGENSTRAT data based on a given BED file — filter_bed","text":"","code":"if (FALSE) # download an example genomic data set prefix <- download_data(dirname = tempdir()) # create an EIGENSTRAT R object from the downloaded data snps <- eigenstrat(prefix) #> Error: object 'prefix' not found  # get the path to an example BED file bed <- file.path(dirname(prefix), \"regions.bed\") #> Error: object 'prefix' not found  # BED file contains regions to keep in an analysis snps_kept <- filter_bed(snps, bed) #> Error: object 'snps' not found # BED file contains regions to remove from an analysis snps_removed <- filter_bed(snps, bed, remove = TRUE) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/loginfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the full log output of an admixr wrapper to the console. — loginfo","title":"Print the full log output of an admixr wrapper to the console. — loginfo","text":"Print full log output admixr wrapper console.","code":""},{"path":"https://bodkan.net/slendr/reference/loginfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the full log output of an admixr wrapper to the console. — loginfo","text":"","code":"loginfo(x, target = NA, save = FALSE, prefix = NA, dir = \".\", suffix = \".txt\")"},{"path":"https://bodkan.net/slendr/reference/loginfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the full log output of an admixr wrapper to the console. — loginfo","text":"x Output one admixr wrappers (d, f4, qpAdm, ...) target specific log examine (relevant multiple target qpAdm runs) save Save log output disk? prefix Prefix output log file(s) (name admixr command default) dir directory save log file(s)? suffix Suffix output log file(s) (\".txt\" default)","code":""},{"path":"https://bodkan.net/slendr/reference/loginfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print the full log output of an admixr wrapper to the console. — loginfo","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # define a set of populations to analyze and calculate a D statistic pops <- c(\"French\", \"Sardinian\", \"Han\", \"Papuan\", \"Khomani_San\", \"Mbuti\", \"Dinka\") result_d <- d(     W = pops, X = \"Yoruba\", Y = \"Vindija\", Z = \"Chimp\",     data = snps ) #> Error: object 'snps' not found  # examine the full log output associated with the returned object loginfo(result_d) #> Error: object 'result_d' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/merge_eigenstrat.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge two sets of EIGENSTRAT datasets — merge_eigenstrat","title":"Merge two sets of EIGENSTRAT datasets — merge_eigenstrat","text":"function utilizes 'mergeit' command distributed ADMIXTOOLS.","code":""},{"path":"https://bodkan.net/slendr/reference/merge_eigenstrat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge two sets of EIGENSTRAT datasets — merge_eigenstrat","text":"","code":"merge_eigenstrat(merged, a, b, strandcheck = \"NO\")"},{"path":"https://bodkan.net/slendr/reference/merge_eigenstrat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge two sets of EIGENSTRAT datasets — merge_eigenstrat","text":"merged Prefix path merged EIGENSTRAT snp/ind/geno trio. , b Two EIGENSTRAT objects merge. strandcheck Deal potential strand issues? Mostly historic reasons. details see README ADMIXTOOLS convertf.","code":""},{"path":"https://bodkan.net/slendr/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"Added via usethis::use_pipe().","code":""},{"path":"https://bodkan.net/slendr/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://bodkan.net/slendr/reference/print.EIGENSTRAT.html","id":null,"dir":"Reference","previous_headings":"","what":"EIGENSTRAT print method — print.EIGENSTRAT","title":"EIGENSTRAT print method — print.EIGENSTRAT","text":"Print EIGENSTRAT object components.","code":""},{"path":"https://bodkan.net/slendr/reference/print.EIGENSTRAT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EIGENSTRAT print method — print.EIGENSTRAT","text":"","code":"# S3 method for class 'EIGENSTRAT' print(x, ...)"},{"path":"https://bodkan.net/slendr/reference/print.EIGENSTRAT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"EIGENSTRAT print method — print.EIGENSTRAT","text":"x EIGENSTRAT data object. ... arguments passed methods.","code":""},{"path":"https://bodkan.net/slendr/reference/print.admixr_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print out the admixr result object (dataframe or a list) without showing the hidden attributes. — print.admixr_result","title":"Print out the admixr result object (dataframe or a list) without showing the hidden attributes. — print.admixr_result","text":"Print admixr result object (dataframe list) without showing hidden attributes.","code":""},{"path":"https://bodkan.net/slendr/reference/print.admixr_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print out the admixr result object (dataframe or a list) without showing the hidden attributes. — print.admixr_result","text":"","code":"# S3 method for class 'admixr_result' print(x, ...)"},{"path":"https://bodkan.net/slendr/reference/print.admixr_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print out the admixr result object (dataframe or a list) without showing the hidden attributes. — print.admixr_result","text":"x admixr output object (dataframe list produced qpAdm/qpWave) ... Additional arguments passed print.","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate ancestry proportions in a set of target populations. — qpAdm","title":"Calculate ancestry proportions in a set of target populations. — qpAdm","text":"Calculate ancestry proportions set target populations.","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate ancestry proportions in a set of target populations. — qpAdm","text":"","code":"qpAdm(   data,   target,   sources,   outgroups,   outdir = NULL,   params = list(allsnps = \"YES\", summary = \"YES\", details = \"YES\") )"},{"path":"https://bodkan.net/slendr/reference/qpAdm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate ancestry proportions in a set of target populations. — qpAdm","text":"data EIGENSTRAT data object. target Vector target populations (evaluated one time). sources Source populations related true ancestors. outgroups Outgroup populations. outdir put generated files (temporary directory default). params Named list parameters values. instance, params = list(allsnps = \"YES\") params = list(blgsize = 0.01) (arbitrary combination parameters using list multiple named elements).","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate ancestry proportions in a set of target populations. — qpAdm","text":"List three components:     1. estimated ancestry proportions     2. ranks statistics     3. analysis patterns (possible subsets ancestry sources).","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate ancestry proportions in a set of target populations. — qpAdm","text":"","code":"if (FALSE) # download example data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # estimate the proportion of Neandertal ancestry in a French # individual and other associated qpAdm statistics (see detailed # description in the tutorial vignette) result <- qpAdm(     target = \"French\",     sources = c(\"Vindija\", \"Yoruba\"),     outgroups = c(\"Chimp\", \"Denisova\", \"Altai\"),     data = snps ) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/qpAdm_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","title":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","text":"Filter p-value larger specified cuttof admixture proportions 0 1.","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","text":"","code":"qpAdm_filter(x, p = 0.05)"},{"path":"https://bodkan.net/slendr/reference/qpAdm_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","text":"x Output qpAdm_rotation() function p p-value cutoff (default 0: filter sensible admixture proportions)","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","text":"qpAdm_rotation object filtered based p-value","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_filter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter qpAdm rotation results for only 'sensible' models — qpAdm_filter","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # find the set of most likely two-source qpAdm models of # a French individual - produce only the 'proportions' # qpAdm summary models <- qpAdm_rotation(     data = snps,     target = \"French\",     candidates = c(\"Dinka\", \"Mbuti\", \"Yoruba\", \"Vindija\",                    \"Altai\", \"Denisova\", \"Chimp\"),     minimize = TRUE,     nsources = 2,     ncores = 2,     fulloutput = FALSE ) #> Error: object 'snps' not found  # filter out models which can clearly be rejected fits <- qpAdm_filter(models, p = 0.05) #> Error: object 'models' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/qpAdm_rotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","title":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","text":"Fit qpAdm models based rotation strategy described Harney et al. 2020 (bioRxiv)","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_rotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","text":"","code":"qpAdm_rotation(   data,   target,   candidates,   minimize = TRUE,   nsources = 2,   ncores = 1,   fulloutput = FALSE,   params = NULL )"},{"path":"https://bodkan.net/slendr/reference/qpAdm_rotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","text":"data EIGENSTRAT dataset target Target population modeled admixed candidates Potential candidates sources outgroups minimize Test also possible subsets outgroups? (default TRUE) nsources Number sources pull candidates ncores Number CPU cores utilize model fitting fulloutput Report also 'ranks' 'subsets' analysis qpAdm addition admixture proportions results? (default FALSE) params Named list parameters values passed qpAdm().","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_rotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","text":"qpAdm list proportions, ranks subsets elements (  traditional qpAdm run) just proportions (determined value   'fulloutput' argument)","code":""},{"path":"https://bodkan.net/slendr/reference/qpAdm_rotation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit qpAdm models based on the rotation strategy described in Harney et al. 2020 (bioRxiv) — qpAdm_rotation","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # find the set of most likely two-source qpAdm models of # a French individual - produce only the 'proportions' # qpAdm summary models <- qpAdm_rotation(     data = snps,     target = \"French\",     candidates = c(\"Dinka\", \"Mbuti\", \"Yoruba\", \"Vindija\",                    \"Altai\", \"Denisova\", \"Chimp\"),     minimize = TRUE,     nsources = 2,     ncores = 2,     fulloutput = FALSE ) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"Given set 'left' populations, estimate lowest number necessary admixture sources related set 'right' populations.","code":""},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"","code":"qpWave(   data,   left,   right,   maxrank = NULL,   details = FALSE,   outdir = NULL,   params = NULL )"},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"data EIGENSTRAT data object. left, right Character vectors populations labels. maxrank Maximum rank test . details Return , B matrices used rank calculations? outdir put generated files (temporary directory default). params Named list parameters values. instance, params = list(allsnps = \"YES\") params = list(blgsize = 0.01) (arbitrary combination parameters using list multiple named elements).","code":""},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"Table rank test results.","code":""},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"shown (Reich, Nature 2012 - Reconstructing Native American population history) 'left' populations mixtures N different sources related set 'right' populations, rank matrix form \\(f_4(left_i, left_j; right_k, right_l)\\) rank N - 1. function uses ADMIXTOOLS command qpWave find lowest possible rank matrix consistent data.","code":""},{"path":"https://bodkan.net/slendr/reference/qpWave.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the most likely number of ancestry waves using the qpWave method. — qpWave","text":"","code":"if (FALSE) # download example data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # run the qpWave wrapper (detailed description in the tutorial vignette) result <- qpWave(      left = c(\"French\", \"Sardinian\", \"Han\"),      right = c(\"Altai\", \"Yoruba\", \"Mbuti\"),      data = snps ) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/read_ind.html","id":null,"dir":"Reference","previous_headings":"","what":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","title":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","text":"functions read one part EIGENSTRAT dataset trio.","code":""},{"path":"https://bodkan.net/slendr/reference/read_ind.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","text":"","code":"read_ind(data)  read_snp(data, exclude = FALSE)  read_geno(data)"},{"path":"https://bodkan.net/slendr/reference/read_ind.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","text":"data EIGENSTRAT data object. exclude Read list excluded SNPs?","code":""},{"path":"https://bodkan.net/slendr/reference/read_ind.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","text":"data.frame object.","code":""},{"path":"https://bodkan.net/slendr/reference/read_ind.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read an EIGENSTRAT ind/snp/geno file. — read_ind","text":"Note read_geno() read plain-text geno files, compressed ones.","code":""},{"path":"https://bodkan.net/slendr/reference/read_output.html","id":null,"dir":"Reference","previous_headings":"","what":"Read an output file from one of the ADMIXTOOLS programs. — read_output","title":"Read an output file from one of the ADMIXTOOLS programs. — read_output","text":"Read output file one ADMIXTOOLS programs.","code":""},{"path":"https://bodkan.net/slendr/reference/read_output.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read an output file from one of the ADMIXTOOLS programs. — read_output","text":"","code":"read_output(file, ...)"},{"path":"https://bodkan.net/slendr/reference/read_output.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read an output file from one of the ADMIXTOOLS programs. — read_output","text":"file path output file. ... See 'details' argument qpWave.","code":""},{"path":"https://bodkan.net/slendr/reference/read_output.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read an output file from one of the ADMIXTOOLS programs. — read_output","text":"tibble results.","code":""},{"path":"https://bodkan.net/slendr/reference/relabel.html","id":null,"dir":"Reference","previous_headings":"","what":"Change labels of populations or samples — relabel","title":"Change labels of populations or samples — relabel","text":"Replace population/sample names specified group labels.","code":""},{"path":"https://bodkan.net/slendr/reference/relabel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Change labels of populations or samples — relabel","text":"","code":"relabel(data, ..., outfile = tempfile(fileext = \".ind\"))"},{"path":"https://bodkan.net/slendr/reference/relabel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Change labels of populations or samples — relabel","text":"data EIGENSTRAT trio. ... Population/sample names merge (new group defined character vector). outfile Path output snp file coordinates excluded sites.","code":""},{"path":"https://bodkan.net/slendr/reference/relabel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Change labels of populations or samples — relabel","text":"Updated S3 EIGENSTRAT data object additional 'group' slot     specifying path new ind file. #'","code":""},{"path":"https://bodkan.net/slendr/reference/relabel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Change labels of populations or samples — relabel","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # group individual samples into larger populations, creating a new # EIGENSTRAT R object new_snps <- relabel(     snps,     European = c(\"French\", \"Sardinian\"),     African = c(\"Dinka\", \"Yoruba\", \"Mbuti\", \"Khomani_San\"),     Archaic = c(\"Vindija\", \"Altai\", \"Denisova\") ) #> Error: object 'snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/reset.html","id":null,"dir":"Reference","previous_headings":"","what":"Reset modifications to an EIGENSTRAT object — reset","title":"Reset modifications to an EIGENSTRAT object — reset","text":"Set 'exclude' 'group' modifications snp ind files, effectively resetting dataset original state.","code":""},{"path":"https://bodkan.net/slendr/reference/reset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reset modifications to an EIGENSTRAT object — reset","text":"","code":"reset(data)"},{"path":"https://bodkan.net/slendr/reference/reset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reset modifications to an EIGENSTRAT object — reset","text":"data EIGENSTRAT data object.","code":""},{"path":"https://bodkan.net/slendr/reference/reset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reset modifications to an EIGENSTRAT object — reset","text":"EIGENSTRAT data S3 object.","code":""},{"path":"https://bodkan.net/slendr/reference/reset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reset modifications to an EIGENSTRAT object — reset","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # group individual samples into larger populations, creating a new # EIGENSTRAT R object new_snps <- relabel(     snps,     European = c(\"French\", \"Sardinian\"),     African = c(\"Dinka\", \"Yoruba\", \"Mbuti\", \"Khomani_San\"),     Archaic = c(\"Vindija\", \"Altai\", \"Denisova\") ) #> Error: object 'snps' not found  # remove the population grouping in the previous step - this # results in the same EIGENSTRAT object tht we started with original_snps <- reset(new_snps) #> Error: object 'new_snps' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/transversions_only.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove transversions (C->T and G->A substitutions) — transversions_only","title":"Remove transversions (C->T and G->A substitutions) — transversions_only","text":"Remove substitutions likely result ancient DNA damage (C->T G->substitutions).","code":""},{"path":"https://bodkan.net/slendr/reference/transversions_only.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove transversions (C->T and G->A substitutions) — transversions_only","text":"","code":"transversions_only(data, outfile = tempfile(fileext = \".snp\"))"},{"path":"https://bodkan.net/slendr/reference/transversions_only.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove transversions (C->T and G->A substitutions) — transversions_only","text":"data EIGENSTRAT data object. outfile Path output snp file coordinates excluded sites.","code":""},{"path":"https://bodkan.net/slendr/reference/transversions_only.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove transversions (C->T and G->A substitutions) — transversions_only","text":"Updated S3 EIGENSTRAT data object additional 'exclude' slot     specifying path set SNPs removed downstream     analysis.","code":""},{"path":"https://bodkan.net/slendr/reference/transversions_only.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove transversions (C->T and G->A substitutions) — transversions_only","text":"","code":"if (FALSE) # download an example genomic data set and prepare it for analysis snps <- eigenstrat(download_data(dirname = tempdir()))  # perform the calculation only on transversions snps_tv <- transversions_only(snps) #> Error: object 'snps' not found results_d <- d(W = \"French\", X = \"Dinka\", Y = \"Altai\", Z = \"Chimp\", data = snps_tv) #> Error: object 'snps_tv' not found  # \\dontrun{}"},{"path":"https://bodkan.net/slendr/reference/write_ind.html","id":null,"dir":"Reference","previous_headings":"","what":"Write an EIGENSTRAT ind/snp/geno file. — write_ind","title":"Write an EIGENSTRAT ind/snp/geno file. — write_ind","text":"Write EIGENSTRAT ind/snp/geno file.","code":""},{"path":"https://bodkan.net/slendr/reference/write_ind.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write an EIGENSTRAT ind/snp/geno file. — write_ind","text":"","code":"write_ind(df, file)  write_snp(df, file)  write_geno(df, file)"},{"path":"https://bodkan.net/slendr/reference/write_ind.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write an EIGENSTRAT ind/snp/geno file. — write_ind","text":"df data.frame object. file Path output file.","code":""},{"path":[]},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-092","dir":"Changelog","previous_headings":"","what":"admixr 0.9.2","title":"admixr 0.9.2","text":"CRAN release: 2025-11-22 Fixed problem qpAdm_rotation nsources >= 3. Input data type EIGENSTRAT checked user-facing functions operate data. Made necessary changes upgrade latest ADMIXTOOLS 8.0.2 (users encouraged upgrade ADMIXTOOLS installation, ADMIXTOOLS always maintain backwards compatibility earlier releases). presence mergeit qpfstats $PATH now checked library(admixr) called.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-091","dir":"Changelog","previous_headings":"","what":"admixr 0.9.1","title":"admixr 0.9.1","text":"CRAN release: 2020-07-03 Added executable examples function. First official CRAN release! 🎉","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-090","dir":"Changelog","previous_headings":"","what":"admixr 0.9.0","title":"admixr 0.9.0","text":"New prototype implementation exhaustive search qpAdm models rotation sources outgroups (qpAdm_rotation()). New tutorial describing qpAdm_rotation() procedure. Fixed broken regex parsing qpWave log files cases. Added type checking couple functions (wrappers type checked yet).","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-087","dir":"Changelog","previous_headings":"","what":"admixr 0.8.7","title":"admixr 0.8.7","text":"qpAdm proportions table now shows p-values SNP counts (overall analysis also target sample).","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-086","dir":"Changelog","previous_headings":"","what":"admixr 0.8.6","title":"admixr 0.8.6","text":"Satisfying checks various testing servers.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-085","dir":"Changelog","previous_headings":"","what":"admixr 0.8.5","title":"admixr 0.8.5","text":"Cleaned build procedure.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-084","dir":"Changelog","previous_headings":"","what":"admixr 0.8.4","title":"admixr 0.8.4","text":"Fixed imports.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-083","dir":"Changelog","previous_headings":"","what":"admixr 0.8.3","title":"admixr 0.8.3","text":"Updated license.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-082","dir":"Changelog","previous_headings":"","what":"admixr 0.8.2","title":"admixr 0.8.2","text":"Expanded tests. Prepared first CRAN submission.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-081","dir":"Changelog","previous_headings":"","what":"admixr 0.8.1","title":"admixr 0.8.1","text":"Fixed minor bug single-source qpAdm analyses. package now detects correctly handles missing “subsets/patterns” information.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-080","dir":"Changelog","previous_headings":"","what":"admixr 0.8.0","title":"admixr 0.8.0","text":"Finally resumed development admixr! Apologies everyone wait long. Thank patience feedback since last release. hope things start moving little bit faster reach version 1.0 next couple months. New features improvements: New function loginfo() operates output object admixr wrapper shows full log output (“log file” ADMIXTOOLS jargon) associated analysis. also options saving log file permanent location show log file target sample interest (relevant qpAdm analyses multiple targets ). admixr can now (hopefully) detect broken/truncated output files generated ADMIXTOOLS whenever fatal issue analysis. package now detect inform user. Removed qpAdm argument details - user always want see full analysis summary option redundant. still kept qpWave - now, figure useful full output actually . Given implementation loginfo() , might remove argument qpWave point soon. function download_data() now fetches data stable location.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-071","dir":"Changelog","previous_headings":"","what":"admixr 0.7.1","title":"admixr 0.7.1","text":"Parse admixture proportions “best coefficients” line qpAdm output file.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-070","dir":"Changelog","previous_headings":"","what":"admixr 0.7.0","title":"admixr 0.7.0","text":"Fixed handling warnings dealing duplicated populations. 9s now replaced NAs read_geno() write_geno(), makes convenient write custom analytic code working data.frames. Renamed qpAdm() output elements changed function signature.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-063","dir":"Changelog","previous_headings":"","what":"admixr 0.6.3","title":"admixr 0.6.3","text":"Rename keep_transversions() transversions_only(). old function now deprecated. print.EIGENSTRAT() now uses pre-calculated numbers removed/remaining sites, instead calculating every time. Printing EIGENSTRAT objects now also shows “group” “exclude” modifiers present.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-062","dir":"Changelog","previous_headings":"","what":"admixr 0.6.2","title":"admixr 0.6.2","text":"read_output() made public. Fixed issues parsing mis-formatted ind files (tabs ends lines etc.).","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-061","dir":"Changelog","previous_headings":"","what":"admixr 0.6.1","title":"admixr 0.6.1","text":"turned dragging along Rcpp Boost dependencies just VCF -> EIGENSTRAT conversion function causes unnecessary complications installation process. ’s worth package used small fraction potential users. function removed vcf2eigenstrat program maintained repository.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-060","dir":"Changelog","previous_headings":"","what":"admixr 0.6.0","title":"admixr 0.6.0","text":"Conversion VCF EIGENSTRAT format now implemented C++ approximately infinitely faster old conversion function written pure R. Conversion EIGENSTRAT VCF removed.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-050","dir":"Changelog","previous_headings":"","what":"admixr 0.5.0","title":"admixr 0.5.0","text":"Added full implementations qpWave() qpAdm() functions. filter_bed() now implemented simply calling bedtools background. turned way faster memory efficient previous data.table-based solution.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-041","dir":"Changelog","previous_headings":"","what":"admixr 0.4.1","title":"admixr 0.4.1","text":"Fixed missing group_labels() update. Removed huge built-data set. Implemented download_data() function fetches example data set web.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-040","dir":"Changelog","previous_headings":"","what":"admixr 0.4.0","title":"admixr 0.4.0","text":"package now tutorial vignette describing main functionality. Simple SNP dataset now included package. API many utility functions simplified internals re-written. filter_sites now implemented using data.table allows overlap arbitrary BED file.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-030","dir":"Changelog","previous_headings":"","what":"admixr 0.3.0","title":"admixr 0.3.0","text":"wrappers given simpler names (qpDstat() -> d(), qpF4ratio() -> f4ratio(), etc). F4 statistic can now calculated using separate f4() function (f4mode parameter remains d() function though, f4() calls d() internally). tests performed Travis CI using installed compiled ADMIXTOOLS software.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-020","dir":"Changelog","previous_headings":"","what":"admixr 0.2.0","title":"admixr 0.2.0","text":"package now includes qpAdm functionality. Formal tests implemented wrapper functions implemented.","code":""},{"path":"https://bodkan.net/slendr/news/index.html","id":"admixr-010","dir":"Changelog","previous_headings":"","what":"admixr 0.1.0","title":"admixr 0.1.0","text":"Implemented: D statistic qpDstat f4 statistic qpDstat(f4mode = TRUE) f4-ratio statistic qpF4Ratio f3 statistic qp3Pop","code":""}]
