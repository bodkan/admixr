<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Interface for the Software Package ADMIXTOOLS ‚Ä¢ slendr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="An Interface for the Software Package ADMIXTOOLS">
<meta name="description" content="An interface for various command-line tools provided by the software suite ADMIXTOOLS (&lt;https://github.com/DReichLab/AdmixTools&gt;). Wrapper functions completely automate the generation of intermediate configuration files, run ADMIXTOOLS programs on the command-line in the background, and extract statistics of interest from plain-text files which they produce. This allows users to avoid dealing with low-level technical details of shell scripting (which is requried by traditional ADMIXTOOLS workflows) and focus on their research problem at hand instead. A set of complementary functions for processing and filtering of data in the EIGENSTRAT format is also provided.">
<meta property="og:description" content="An interface for various command-line tools provided by the software suite ADMIXTOOLS (&lt;https://github.com/DReichLab/AdmixTools&gt;). Wrapper functions completely automate the generation of intermediate configuration files, run ADMIXTOOLS programs on the command-line in the background, and extract statistics of interest from plain-text files which they produce. This allows users to avoid dealing with low-level technical details of shell scripting (which is requried by traditional ADMIXTOOLS workflows) and focus on their research problem at hand instead. A set of complementary functions for processing and filtering of data in the EIGENSTRAT format is also provided.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">slendr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html"><span class="fa fa-question-circle"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/vignette-01-tutorial.html">Basic overview of the admixr package</a></li>
    <li><a class="dropdown-item" href="articles/vignette-02-qpAdm.html">Running qpAdm models with the 'rotation' strategy</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bodkan/admixr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="admixr-an-r-interface-for-the-admixtools-software">
<em>admixr</em>: an R interface for the ADMIXTOOLS software<a class="anchor" aria-label="anchor" href="#admixr-an-r-interface-for-the-admixtools-software"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<div class="section level2">
<h2 id="what-is-admixr">What is <em>admixr</em>?<a class="anchor" aria-label="anchor" href="#what-is-admixr"></a>
</h2>
<p>The <em>admixr</em> package provides a convenient R interface to <a href="https://github.com/DReichLab/AdmixTools/" class="external-link">ADMIXTOOLS</a>, a widely used software package for calculating admixture statistics and testing population admixture hypotheses.</p>
<p>A typical ADMIXTOOLS workflow often involves a combination of <code>sed</code>/<code>awk</code>/shell scripting and manual editing to create different configuration files. These are then passed as command-line arguments to one of ADMIXTOOLS commands, and control how to run a particular analysis. The results of such computation are then usually redirected to another file, which needs to be parsed by the user to extract values of interest, often using command-line utilities again or by manual copy-pasting, and finally analysed in R, Excel or another program.</p>
<p>This workflow can be a little cumbersome, especially if one wants to explore many hypotheses involving different combinations of populations or data filtering strategies. Most importantly, it makes it difficult to follow the rules of best practice for reproducible science, especially given the need for manual intervention on the command-line or custom shell scripting to orchestrate more complex pipelines.</p>
<p><em>admixr</em> makes it possible to perform all stages of an ADMIXTOOLS analysis entirely from R. It provides a <a href="https://bodkan.net/admixr/reference/index.html" class="external-link">set of convenient functions</a> that completely remove the need for ‚Äúlow-level‚Äù configuration of individual ADMIXTOOLS programs, allowing users to focus on the analysis itself.</p>
</div>
<div class="section level2">
<h2 id="citing-admixr">Citing <em>admixr</em>
<a class="anchor" aria-label="anchor" href="#citing-admixr"></a>
</h2>
<p><em>admixr</em> is now published as an <a href="https://doi.org/10.1093/bioinformatics/btz030" class="external-link"><em>Application Note</em></a> in the journal Bioinformatics. If you use it in your work, please cite the paper! You will join an <a href="https://scholar.google.com/scholar?cites=13286994334855947290" class="external-link">excellent company</a> of papers which have used it to do amazing research. üôÇ</p>
<blockquote>
<p>Petr Martin, Vernot Benjamin, Kelso Janet. admixr‚ÄîR package for reproducible analyses using ADMIXTOOLS. Bioinformatics, Volume 35, Issue 17 (2019), pages 3194‚Äì3195. doi: 10.1093/bioinformatics/btz030.</p>
</blockquote>
<p>Citations help me justify further development and fixing bugs! Thank you! üñ§</p>
</div>
<div class="section level2">
<h2 id="installation-instructions">Installation instructions<a class="anchor" aria-label="anchor" href="#installation-instructions"></a>
</h2>
<div class="section level4">
<h4 id="browser-based-rstudio-session">Browser-based RStudio session<a class="anchor" aria-label="anchor" href="#browser-based-rstudio-session"></a>
</h4>
<p>You can try out <em>admixr</em> without installation directly in your browser! Simply click on <a href="http://beta.mybinder.org/v2/gh/bodkan/admixr/main?urlpath=rstudio" class="external-link"><img src="http://mybinder.org/badge.svg" alt="Binder"></a> and after a short moment you will get a Binder RStudio could session running in your web browser. However, please note that Binder‚Äôs computational resources are extremely limited so you might run into issues if you try to run extremely resource-intensive computations.</p>
</div>
<div class="section level4">
<h4 id="latest-stable-version">Latest stable version<a class="anchor" aria-label="anchor" href="#latest-stable-version"></a>
</h4>
<p>The package is available <a href="https://cran.r-project.org/package=admixr" class="external-link">on CRAN</a>. You can install it simply by running</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"admixr"</span><span class="op">)</span></span></code></pre></div>
<p>from your R session. This the recommended procedure for most users.</p>
</div>
<div class="section level4">
<h4 id="development-version">Development version<a class="anchor" aria-label="anchor" href="#development-version"></a>
</h4>
<p>To install the development version from Github (which might be slightly ahead in terms of new features and bugfixes compared to the stable release on CRAN), you need the R package <em>devtools</em>. You can run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bodkan/admixr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="installing-admixtools">Installing ADMIXTOOLS<a class="anchor" aria-label="anchor" href="#installing-admixtools"></a>
</h4>
<p>In order to use the <em>admixr</em> package, you need a working installation of ADMIXTOOLS. You can find installation instructions <a href="https://github.com/DReichLab/AdmixTools/blob/master/README.INSTALL" class="external-link">here</a>.</p>
<p>Furthermore, you also need to make sure that R can find ADMIXTOOLS binaries on the <code>$PATH</code>. You can achieve this by specifying <code>PATH=&lt;path to the location of ADMIXTOOLS programs&gt;</code> in the <code>.Renviron</code> file in your home directory. If R cannot find ADMIXTOOLS utilities, you will get a warning upon loading <code><a href="https://github.com/bodkan/admixr" class="external-link">library(admixr)</a></code> in your R session.</p>
<p><strong>In terms of the version of ADMIXTOOLS required by <em>admixr</em>, there is no formal requirement. However, please note that the package is generally developed and tested against the latest ADMIXTOOLS release (which is currently version 8.0.2).</strong></p>
</div>
</div>
<div class="section level2">
<h2 id="example-analysis">Example analysis<a class="anchor" aria-label="anchor" href="#example-analysis"></a>
</h2>
<p>This is all the code that you need to perform ADMIXTOOLS analyses using this package! No shell scripting, no copy-pasting and manual editing of text files. The only thing you need is a working ADMIXTOOLS installation and a path to EIGENSTRAT data (a trio of ind/snp/geno files), which we call <code>prefix</code> here.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bodkan/admixr" class="external-link">admixr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download a small testing dataset to a temporary directory and process it for use in R</span></span>
<span><span class="va">snp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/eigenstrat.html">eigenstrat</a></span><span class="op">(</span><span class="fu"><a href="reference/download_data.html">download_data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/f4ratio.html">d</a></span><span class="op">(</span></span>
<span>  W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"French"</span>, <span class="st">"Sardinian"</span><span class="op">)</span>, X <span class="op">=</span> <span class="st">"Yoruba"</span>, Y <span class="op">=</span> <span class="st">"Vindija"</span>, Z <span class="op">=</span> <span class="st">"Chimp"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">snp_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span></span></code></pre></div>
<p>Note that a single call to the <code>d</code> function generates all required intermediate config and population files, runs ADMIXTOOLS, parses its log output and returns the result as a <code>data.frame</code> object with the D statistics results. It does all of this behind the scenes, without the user having to deal with low-level technical details.</p>
</div>
<div class="section level2">
<h2 id="more-information">More information<a class="anchor" aria-label="anchor" href="#more-information"></a>
</h2>
<p>To see many more examples of admixr in action, please check out the <a href="https://bodkan.net/admixr/articles/vignette-01-tutorial.html" class="external-link">tutorial vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="is-admixr-related-to-admixtools-2">Is <em>admixr</em> related to ADMIXTOOLS 2?<a class="anchor" aria-label="anchor" href="#is-admixr-related-to-admixtools-2"></a>
</h2>
<p>Recently, a new R package called <a href="https://uqrmaie1.github.io/admixtools/" class="external-link">ADMIXTOOLS 2</a> appeared on the horizon, offering a re-implementation of several features of the original ADMIXTOOLS suite of command-line programs.</p>
<p>The <em>admixr</em> project is not related to that initiative. It is not a pre-cursor to it, nor it is superseeded by it. I have never used ADMIXTOOLS 2 myself, but from the looks of it it seems to offer some very interesting features for fitting complex admixture graphs, which is certainly something which <em>admixr</em> does not do.</p>
<p><strong>The bottom-line is this:</strong> as long as the <a href="https://github.com/DReichLab/AdmixTools" class="external-link">original ADMIXTOOLS</a> continues to be developed and maintained, <em>admixr</em> remains relevant and useful and will continue to be supported. ADMIXTOOLS is one of the most battle-tested pieces of software in population genetics‚Äîif you‚Äôre happy with the set of features it provides and if you‚Äôre happy with <em>admixr</em> itself, there is no real reason to move away from either of them.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=admixr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/bodkan/admixr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bodkan/admixr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing admixr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Martin Petr <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4879-8421" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=admixr" class="external-link"><img src="https://www.r-pkg.org/badges/version/admixr" alt="CRAN-version"></a></li>
<li><a href="https://cran.r-project.org/package=admixr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/admixr" alt="CRAN-downloads"></a></li>
<li><a href="https://github.com/bodkan/admixr/actions" class="external-link"><img src="https://github.com/bodkan/admixr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="http://beta.mybinder.org/v2/gh/bodkan/admixr/main?urlpath=rstudio" class="external-link"><img src="http://mybinder.org/badge.svg" alt="Binder"></a></li>
<li><a href="https://app.codecov.io/github/bodkan/admixr?branch=main" class="external-link"><img src="https://codecov.io/gh/bodkan/admixr/branch/main/graph/badge.svg" alt="Coverage status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Petr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
